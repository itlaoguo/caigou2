import{_ as z,j as tt,l as L,Q as st,h as W,S as ct,U as et,V as ut,N as pt,W as gt,X as ht,q as vt,C as ft,Y as rt,g as Y,$ as dt,a0 as R,a1 as yt,O as Z,a2 as mt,Z as V,a3 as St,a4 as j,I as q,a5 as xt,R as nt,a6 as Ct,b as T,K as Gt,a7 as bt,a8 as _t,a9 as Dt,aa as Pt,ab as Lt,ac as It,m as Rt,F as At,ad as Ot,ae as wt,u as N}from"./installCanvasRenderer-jY-EmqBn.js";import{m as Tt}from"./install-D1NThLa7.js";var kt=function(n,r){if(r==="all")return{type:"all",title:n.getLocaleModel().get(["legend","selector","all"])};if(r==="inverse")return{type:"inverse",title:n.getLocaleModel().get(["legend","selector","inverse"])}},$=function(n){z(r,n);function r(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=r.type,t.layoutMode={type:"box",ignoreSize:!0},t}return r.prototype.init=function(t,e,a){this.mergeDefaultAndTheme(t,a),t.selected=t.selected||{},this._updateSelector(t)},r.prototype.mergeOption=function(t,e){n.prototype.mergeOption.call(this,t,e),this._updateSelector(t)},r.prototype._updateSelector=function(t){var e=t.selector,a=this.ecModel;e===!0&&(e=t.selector=["all","inverse"]),tt(e)&&L(e,function(i,l){W(i)&&(i={type:i}),e[l]=st(i,kt(a,i.type))})},r.prototype.optionUpdated=function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&this.get("selectedMode")==="single"){for(var e=!1,a=0;a<t.length;a++){var i=t[a].get("name");if(this.isSelected(i)){this.select(i),e=!0;break}}!e&&this.select(t[0].get("name"))}},r.prototype._updateData=function(t){var e=[],a=[];t.eachRawSeries(function(s){var o=s.name;a.push(o);var c;if(s.legendVisualProvider){var v=s.legendVisualProvider,p=v.getAllNames();t.isSeriesFiltered(s)||(a=a.concat(p)),p.length?e=e.concat(p):c=!0}else c=!0;c&&ct(s)&&e.push(s.name)}),this._availableNames=a;var i=this.get("data")||e,l=et(),f=ut(i,function(s){return(W(s)||gt(s))&&(s={name:s}),l.get(s.name)?null:(l.set(s.name,!0),new pt(s,this,this.ecModel))},this);this._data=ht(f,function(s){return!!s})},r.prototype.getData=function(){return this._data},r.prototype.select=function(t){var e=this.option.selected,a=this.get("selectedMode");if(a==="single"){var i=this._data;L(i,function(l){e[l.get("name")]=!1})}e[t]=!0},r.prototype.unSelect=function(t){this.get("selectedMode")!=="single"&&(this.option.selected[t]=!1)},r.prototype.toggleSelected=function(t){var e=this.option.selected;e.hasOwnProperty(t)||(e[t]=!0),this[e[t]?"unSelect":"select"](t)},r.prototype.allSelect=function(){var t=this._data,e=this.option.selected;L(t,function(a){e[a.get("name",!0)]=!0})},r.prototype.inverseSelect=function(){var t=this._data,e=this.option.selected;L(t,function(a){var i=a.get("name",!0);e.hasOwnProperty(i)||(e[i]=!0),e[i]=!e[i]})},r.prototype.isSelected=function(t){var e=this.option.selected;return!(e.hasOwnProperty(t)&&!e[t])&&vt(this._availableNames,t)>=0},r.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},r.type="legend.plain",r.dependencies=["series"],r.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},r}(ft),I=R,E=L,B=rt,it=function(n){z(r,n);function r(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=r.type,t.newlineDisabled=!1,t}return r.prototype.init=function(){this.group.add(this._contentGroup=new B),this.group.add(this._selectorGroup=new B),this._isFirstRender=!0},r.prototype.getContentGroup=function(){return this._contentGroup},r.prototype.getSelectorGroup=function(){return this._selectorGroup},r.prototype.render=function(t,e,a){var i=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!t.get("show",!0)){var l=t.get("align"),f=t.get("orient");(!l||l==="auto")&&(l=t.get("left")==="right"&&f==="vertical"?"right":"left");var s=t.get("selector",!0),o=t.get("selectorPosition",!0);s&&(!o||o==="auto")&&(o=f==="horizontal"?"end":"start"),this.renderInner(l,t,e,a,s,f,o);var c=t.getBoxLayoutParams(),v={width:a.getWidth(),height:a.getHeight()},p=t.get("padding"),g=Y(c,v,p),h=this.layoutInner(t,l,g,i,s,o),u=Y(dt({width:h.width,height:h.height},c),v,p);this.group.x=u.x-h.x,this.group.y=u.y-h.y,this.group.markRedraw(),this.group.add(this._backgroundEl=Tt(h,t))}},r.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},r.prototype.renderInner=function(t,e,a,i,l,f,s){var o=this.getContentGroup(),c=et(),v=e.get("selectedMode"),p=[];a.eachRawSeries(function(g){!g.get("legendHoverLink")&&p.push(g.id)}),E(e.getData(),function(g,h){var u=g.get("name");if(!this.newlineDisabled&&(u===""||u===`
`)){var m=new B;m.newline=!0,o.add(m);return}var d=a.getSeriesByName(u)[0];if(!c.get(u))if(d){var y=d.getData(),S=y.getVisual("legendLineStyle")||{},b=y.getVisual("legendIcon"),x=y.getVisual("style"),C=this._createItem(d,u,h,g,e,t,S,x,b,v,i);C.on("click",I(J,u,null,i,p)).on("mouseover",I(U,d.name,null,i,p)).on("mouseout",I(K,d.name,null,i,p)),c.set(u,!0)}else a.eachRawSeries(function(G){if(!c.get(u)&&G.legendVisualProvider){var _=G.legendVisualProvider;if(!_.containName(u))return;var k=_.indexOfName(u),D=_.getItemVisual(k,"style"),A=_.getItemVisual(k,"legendIcon"),P=yt(D.fill);P&&P[3]===0&&(P[3]=.2,D=Z(Z({},D),{fill:mt(P,"rgba")}));var O=this._createItem(G,u,h,g,e,t,{},D,A,v,i);O.on("click",I(J,null,u,i,p)).on("mouseover",I(U,null,u,i,p)).on("mouseout",I(K,null,u,i,p)),c.set(u,!0)}},this)},this),l&&this._createSelector(l,e,i,f,s)},r.prototype._createSelector=function(t,e,a,i,l){var f=this.getSelectorGroup();E(t,function(o){var c=o.type,v=new V({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){a.dispatchAction({type:c==="all"?"legendAllSelect":"legendInverseSelect"})}});f.add(v);var p=e.getModel("selectorLabel"),g=e.getModel(["emphasis","selectorLabel"]);St(v,{normal:p,emphasis:g},{defaultText:o.title}),j(v)})},r.prototype._createItem=function(t,e,a,i,l,f,s,o,c,v,p){var g=t.visualDrawType,h=l.get("itemWidth"),u=l.get("itemHeight"),m=l.isSelected(e),d=i.get("symbolRotate"),y=i.get("symbolKeepAspect"),S=i.get("icon");c=S||c||"roundRect";var b=Bt(c,i,s,o,g,m,p),x=new B,C=i.getModel("textStyle");if(q(t.getLegendIcon)&&(!S||S==="inherit"))x.add(t.getLegendIcon({itemWidth:h,itemHeight:u,icon:c,iconRotate:d,itemStyle:b.itemStyle,lineStyle:b.lineStyle,symbolKeepAspect:y}));else{var G=S==="inherit"&&t.getData().getVisual("symbol")?d==="inherit"?t.getData().getVisual("symbolRotate"):d:0;x.add(Wt({itemWidth:h,itemHeight:u,icon:c,iconRotate:G,itemStyle:b.itemStyle,symbolKeepAspect:y}))}var _=f==="left"?h+5:-5,k=f,D=l.get("formatter"),A=e;W(D)&&D?A=D.replace("{name}",e??""):q(D)&&(A=D(e));var P=m?C.getTextColor():i.get("inactiveColor");x.add(new V({style:xt(C,{text:A,x:_,y:u/2,fill:P,align:k,verticalAlign:"middle"},{inheritColor:P})}));var O=new nt({shape:x.getBoundingRect(),invisible:!0}),X=i.getModel("tooltip");return X.get("show")&&Ct({el:O,componentModel:l,itemName:e,itemTooltipOption:X.option}),x.add(O),x.eachChild(function(lt){lt.silent=!0}),O.silent=!v,this.getContentGroup().add(x),j(x),x.__legendDataIndex=a,x},r.prototype.layoutInner=function(t,e,a,i,l,f){var s=this.getContentGroup(),o=this.getSelectorGroup();T(t.get("orient"),s,t.get("itemGap"),a.width,a.height);var c=s.getBoundingRect(),v=[-c.x,-c.y];if(o.markRedraw(),s.markRedraw(),l){T("horizontal",o,t.get("selectorItemGap",!0));var p=o.getBoundingRect(),g=[-p.x,-p.y],h=t.get("selectorButtonGap",!0),u=t.getOrient().index,m=u===0?"width":"height",d=u===0?"height":"width",y=u===0?"y":"x";f==="end"?g[u]+=c[m]+h:v[u]+=p[m]+h,g[1-u]+=c[d]/2-p[d]/2,o.x=g[0],o.y=g[1],s.x=v[0],s.y=v[1];var S={x:0,y:0};return S[m]=c[m]+h+p[m],S[d]=Math.max(c[d],p[d]),S[y]=Math.min(0,p[y]+g[1-u]),S}else return s.x=v[0],s.y=v[1],this.group.getBoundingRect()},r.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},r.type="legend.plain",r}(Gt);function Bt(n,r,t,e,a,i,l){function f(m,d){m.lineWidth==="auto"&&(m.lineWidth=d.lineWidth>0?2:0),E(m,function(y,S){m[S]==="inherit"&&(m[S]=d[S])})}var s=r.getModel("itemStyle"),o=s.getItemStyle(),c=n.lastIndexOf("empty",0)===0?"fill":"stroke",v=s.getShallow("decal");o.decal=!v||v==="inherit"?e.decal:bt(v,l),o.fill==="inherit"&&(o.fill=e[a]),o.stroke==="inherit"&&(o.stroke=e[c]),o.opacity==="inherit"&&(o.opacity=(a==="fill"?e:t).opacity),f(o,e);var p=r.getModel("lineStyle"),g=p.getLineStyle();if(f(g,t),o.fill==="auto"&&(o.fill=e.fill),o.stroke==="auto"&&(o.stroke=e.fill),g.stroke==="auto"&&(g.stroke=e.fill),!i){var h=r.get("inactiveBorderWidth"),u=o[c];o.lineWidth=h==="auto"?e.lineWidth>0&&u?2:0:o.lineWidth,o.fill=r.get("inactiveColor"),o.stroke=r.get("inactiveBorderColor"),g.stroke=p.get("inactiveColor"),g.lineWidth=p.get("inactiveWidth")}return{itemStyle:o,lineStyle:g}}function Wt(n){var r=n.icon||"roundRect",t=_t(r,0,0,n.itemWidth,n.itemHeight,n.itemStyle.fill,n.symbolKeepAspect);return t.setStyle(n.itemStyle),t.rotation=(n.iconRotate||0)*Math.PI/180,t.setOrigin([n.itemWidth/2,n.itemHeight/2]),r.indexOf("empty")>-1&&(t.style.stroke=t.style.fill,t.style.fill="#fff",t.style.lineWidth=2),t}function J(n,r,t,e){K(n,r,t,e),t.dispatchAction({type:"legendToggleSelect",name:n??r}),U(n,r,t,e)}function at(n){for(var r=n.getZr().storage.getDisplayList(),t,e=0,a=r.length;e<a&&!(t=r[e].states.emphasis);)e++;return t&&t.hoverLayer}function U(n,r,t,e){at(t)||t.dispatchAction({type:"highlight",seriesName:n,name:r,excludeSeriesId:e})}function K(n,r,t,e){at(t)||t.dispatchAction({type:"downplay",seriesName:n,name:r,excludeSeriesId:e})}function zt(n){var r=n.findComponents({mainType:"legend"});r&&r.length&&n.filterSeries(function(t){for(var e=0;e<r.length;e++)if(!r[e].isSelected(t.name))return!1;return!0})}function w(n,r,t){var e={},a=n==="toggleSelected",i;return t.eachComponent("legend",function(l){a&&i!=null?l[i?"select":"unSelect"](r.name):n==="allSelect"||n==="inverseSelect"?l[n]():(l[n](r.name),i=l.isSelected(r.name));var f=l.getData();L(f,function(s){var o=s.get("name");if(!(o===`
`||o==="")){var c=l.isSelected(o);e.hasOwnProperty(o)?e[o]=e[o]&&c:e[o]=c}})}),n==="allSelect"||n==="inverseSelect"?{selected:e}:{name:r.name,selected:e}}function Ft(n){n.registerAction("legendToggleSelect","legendselectchanged",R(w,"toggleSelected")),n.registerAction("legendAllSelect","legendselectall",R(w,"allSelect")),n.registerAction("legendInverseSelect","legendinverseselect",R(w,"inverseSelect")),n.registerAction("legendSelect","legendselected",R(w,"select")),n.registerAction("legendUnSelect","legendunselected",R(w,"unSelect"))}function ot(n){n.registerComponentModel($),n.registerComponentView(it),n.registerProcessor(n.PRIORITY.PROCESSOR.SERIES_FILTER,zt),n.registerSubTypeDefaulter("legend",function(){return"plain"}),Ft(n)}var Ht=function(n){z(r,n);function r(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=r.type,t}return r.prototype.setScrollDataIndex=function(t){this.option.scrollDataIndex=t},r.prototype.init=function(t,e,a){var i=Dt(t);n.prototype.init.call(this,t,e,a),Q(this,t,i)},r.prototype.mergeOption=function(t,e){n.prototype.mergeOption.call(this,t,e),Q(this,this.option,t)},r.type="legend.scroll",r.defaultOption=Pt($.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),r}($);function Q(n,r,t){var e=n.getOrient(),a=[1,1];a[e.index]=0,Lt(r,t,{type:"box",ignoreSize:!!a})}var M=rt,F=["width","height"],H=["x","y"],Vt=function(n){z(r,n);function r(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=r.type,t.newlineDisabled=!0,t._currentIndex=0,t}return r.prototype.init=function(){n.prototype.init.call(this),this.group.add(this._containerGroup=new M),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new M)},r.prototype.resetInner=function(){n.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},r.prototype.renderInner=function(t,e,a,i,l,f,s){var o=this;n.prototype.renderInner.call(this,t,e,a,i,l,f,s);var c=this._controllerGroup,v=e.get("pageIconSize",!0),p=tt(v)?v:[v,v];h("pagePrev",0);var g=e.getModel("pageTextStyle");c.add(new V({name:"pageText",style:{text:"xx/xx",fill:g.getTextColor(),font:g.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),h("pageNext",1);function h(u,m){var d=u+"DataIndex",y=It(e.get("pageIcons",!0)[e.getOrient().name][m],{onclick:Rt(o._pageGo,o,d,e,i)},{x:-p[0]/2,y:-p[1]/2,width:p[0],height:p[1]});y.name=u,c.add(y)}},r.prototype.layoutInner=function(t,e,a,i,l,f){var s=this.getSelectorGroup(),o=t.getOrient().index,c=F[o],v=H[o],p=F[1-o],g=H[1-o];l&&T("horizontal",s,t.get("selectorItemGap",!0));var h=t.get("selectorButtonGap",!0),u=s.getBoundingRect(),m=[-u.x,-u.y],d=At(a);l&&(d[c]=a[c]-u[c]-h);var y=this._layoutContentAndController(t,i,d,o,c,p,g,v);if(l){if(f==="end")m[o]+=y[c]+h;else{var S=u[c]+h;m[o]-=S,y[v]-=S}y[c]+=u[c]+h,m[1-o]+=y[g]+y[p]/2-u[p]/2,y[p]=Math.max(y[p],u[p]),y[g]=Math.min(y[g],u[g]+m[1-o]),s.x=m[0],s.y=m[1],s.markRedraw()}return y},r.prototype._layoutContentAndController=function(t,e,a,i,l,f,s,o){var c=this.getContentGroup(),v=this._containerGroup,p=this._controllerGroup;T(t.get("orient"),c,t.get("itemGap"),i?a.width:null,i?null:a.height),T("horizontal",p,t.get("pageButtonItemGap",!0));var g=c.getBoundingRect(),h=p.getBoundingRect(),u=this._showController=g[l]>a[l],m=[-g.x,-g.y];e||(m[i]=c[o]);var d=[0,0],y=[-h.x,-h.y],S=Ot(t.get("pageButtonGap",!0),t.get("itemGap",!0));if(u){var b=t.get("pageButtonPosition",!0);b==="end"?y[i]+=a[l]-h[l]:d[i]+=h[l]+S}y[1-i]+=g[f]/2-h[f]/2,c.setPosition(m),v.setPosition(d),p.setPosition(y);var x={x:0,y:0};if(x[l]=u?a[l]:g[l],x[f]=Math.max(g[f],h[f]),x[s]=Math.min(0,h[s]+y[1-i]),v.__rectSize=a[l],u){var C={x:0,y:0};C[l]=Math.max(a[l]-h[l]-S,0),C[f]=x[f],v.setClipPath(new nt({shape:C})),v.__rectSize=C[l]}else p.eachChild(function(_){_.attr({invisible:!0,silent:!0})});var G=this._getPageInfo(t);return G.pageIndex!=null&&wt(c,{x:G.contentPosition[0],y:G.contentPosition[1]},u?t:null),this._updatePageInfoView(t,G),x},r.prototype._pageGo=function(t,e,a){var i=this._getPageInfo(e)[t];i!=null&&a.dispatchAction({type:"legendScroll",scrollDataIndex:i,legendId:e.id})},r.prototype._updatePageInfoView=function(t,e){var a=this._controllerGroup;L(["pagePrev","pageNext"],function(c){var v=c+"DataIndex",p=e[v]!=null,g=a.childOfName(c);g&&(g.setStyle("fill",p?t.get("pageIconColor",!0):t.get("pageIconInactiveColor",!0)),g.cursor=p?"pointer":"default")});var i=a.childOfName("pageText"),l=t.get("pageFormatter"),f=e.pageIndex,s=f!=null?f+1:0,o=e.pageCount;i&&l&&i.setStyle("text",W(l)?l.replace("{current}",s==null?"":s+"").replace("{total}",o==null?"":o+""):l({current:s,total:o}))},r.prototype._getPageInfo=function(t){var e=t.get("scrollDataIndex",!0),a=this.getContentGroup(),i=this._containerGroup.__rectSize,l=t.getOrient().index,f=F[l],s=H[l],o=this._findTargetItemIndex(e),c=a.children(),v=c[o],p=c.length,g=p?1:0,h={contentPosition:[a.x,a.y],pageCount:g,pageIndex:g-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!v)return h;var u=b(v);h.contentPosition[l]=-u.s;for(var m=o+1,d=u,y=u,S=null;m<=p;++m)S=b(c[m]),(!S&&y.e>d.s+i||S&&!x(S,d.s))&&(y.i>d.i?d=y:d=S,d&&(h.pageNextDataIndex==null&&(h.pageNextDataIndex=d.i),++h.pageCount)),y=S;for(var m=o-1,d=u,y=u,S=null;m>=-1;--m)S=b(c[m]),(!S||!x(y,S.s))&&d.i<y.i&&(y=d,h.pagePrevDataIndex==null&&(h.pagePrevDataIndex=d.i),++h.pageCount,++h.pageIndex),d=S;return h;function b(C){if(C){var G=C.getBoundingRect(),_=G[s]+C[s];return{s:_,e:_+G[f],i:C.__legendDataIndex}}}function x(C,G){return C.e>=G&&C.s<=G+i}},r.prototype._findTargetItemIndex=function(t){if(!this._showController)return 0;var e,a=this.getContentGroup(),i;return a.eachChild(function(l,f){var s=l.__legendDataIndex;i==null&&s!=null&&(i=f),s===t&&(e=f)}),e??i},r.type="legend.scroll",r}(it);function Nt(n){n.registerAction("legendScroll","legendscroll",function(r,t){var e=r.scrollDataIndex;e!=null&&t.eachComponent({mainType:"legend",subType:"scroll",query:r},function(a){a.setScrollDataIndex(e)})})}function $t(n){N(ot),n.registerComponentModel(Ht),n.registerComponentView(Vt),Nt(n)}function Kt(n){N(ot),N($t)}export{Kt as i};
