import{d as P,r as f,g as z,h as r,c as G,o as s,a as l,w as a,b as y,e as i,E as d,x as m,t as q,v as x,j as D}from"./index-OLkvd68Y.js";import{M as H,a as J,b as K,c as Q}from"./menu-CDRUEs78.js";import{b as W}from"./public-CddGFI_6.js";const X={class:"form-submit-container"},Y={class:"form-submit-sub"},Z={class:"form-submit-left"},$={name:"systemAdd"},le=P({...$,props:{fetchData:{type:Function}},setup(M,{expose:B}){const L=M,b=f("无父级"),e=f({permission_name:"",route:"",icon:"",permission_mark:"",component:"",module:"",sort:null,parent_id:0,type:1,hidden:2}),S={permission_name:[{required:!0,message:"请输入",type:"warning"}],type:[{required:!0,message:"请选择",type:"warning"}],parent_id:[{required:!0,message:"请输入",type:"warning"}],route:[{required:!0,message:"请输入",type:"warning"}],component:[{required:!0,message:"请输入",type:"warning"}],permission_mark:[{required:!0,message:"请输入",type:"warning"}],sort:[{required:!0,message:"请输入",type:"warning"}],hidden:[{required:!0,message:"请输入",type:"warning"}]},A=o=>{e.value.type=o,e.value,o==3&&e.value.hidden==1},F=o=>{e.value.hidden=o,e.value};z(()=>{V()});const c=f([]),N=(o,t)=>{},V=async()=>{const o=await H({});c.value=W(o.data),c.value},_=f(!1),k=f(null),w=()=>{k.value.reset(),e.value.id&&(e.value.id=null,delete e.value.id),e.value.hidden=1,e.value.hidden=2},C=()=>{w(),g()},R=async o=>{const t=await J(o);t.code==1e4&&(e.value=t.data)},g=()=>{_.value=!_.value},T=async o=>{if(e.value,o.validateResult===!0){let t=null;e.value.id?t=await K(e.value,e.value.id):t=await Q(e.value),t.code==1e4&&(g(),C(),V(),L.fetchData())}};return B({onSwticher:g,getitemId:R,FormData:e}),(o,t)=>{const p=r("t-input"),u=r("t-form-item"),E=r("t-tree-select"),v=r("t-radio"),U=r("t-radio-group"),I=r("t-input-number"),h=r("t-button"),j=r("t-form"),O=r("t-dialog");return s(),G("div",null,[l(O,{visible:_.value,"onUpdate:visible":t[8]||(t[8]=n=>_.value=n),header:"菜单添加",width:"600",footer:!1,onClose:w},{default:a(()=>[y("div",null,[l(j,{ref_key:"form",ref:k,rules:S,data:e.value,"label-align":"right","label-width":100,onSubmit:T,onReset:C},{default:a(()=>[e.value.parent_id==0?(s(),i(u,{key:0,label:"父级节点",name:"permission_name"},{default:a(()=>[l(p,{modelValue:b.value,"onUpdate:modelValue":t[0]||(t[0]=n=>b.value=n)},null,8,["modelValue"])]),_:1})):(s(),i(u,{key:1,label:"父级节点",name:"parent_id"},{default:a(()=>[l(E,{modelValue:e.value.parent_id,"onUpdate:modelValue":t[1]||(t[1]=n=>e.value.parent_id=n),data:c.value,filterable:"",placeholder:"请选择","tree-props":{checkStrictly:!0,keys:{value:"id",label:"permission_name",children:"children"}},onPopupVisibleChange:N},null,8,["modelValue","data"])]),_:1})),l(u,{label:"菜单类型",name:"type"},{default:a(()=>[l(U,{value:e.value.type,onChange:A},{default:a(()=>[l(v,{value:1},{default:a(()=>t[9]||(t[9]=[m("目录")])),_:1}),l(v,{value:2},{default:a(()=>t[10]||(t[10]=[m("页面")])),_:1}),l(v,{value:3},{default:a(()=>t[11]||(t[11]=[m("按钮")])),_:1})]),_:1},8,["value"])]),_:1}),e.value.type==3||e.value.type==2||e.value.type==1?(s(),i(u,{key:2,label:"菜单名称",name:"permission_name"},{default:a(()=>[l(p,{modelValue:e.value.permission_name,"onUpdate:modelValue":t[2]||(t[2]=n=>e.value.permission_name=n)},null,8,["modelValue"])]),_:1})):d("",!0),e.value.type==1||e.value.type==2?(s(),i(u,{key:3,label:"菜单图标",name:"icon"},{default:a(()=>[l(p,{modelValue:e.value.icon,"onUpdate:modelValue":t[3]||(t[3]=n=>e.value.icon=n)},null,8,["modelValue"])]),_:1})):d("",!0),e.value.type==2||e.value.type==1?(s(),i(u,{key:4,label:"组件名称",name:"route"},{default:a(()=>[l(p,{modelValue:e.value.route,"onUpdate:modelValue":t[4]||(t[4]=n=>e.value.route=n)},null,8,["modelValue"])]),_:1})):d("",!0),e.value.type==2?(s(),i(u,{key:5,label:"组件路径",name:"component"},{default:a(()=>[l(p,{modelValue:e.value.component,"onUpdate:modelValue":t[5]||(t[5]=n=>e.value.component=n)},null,8,["modelValue"])]),_:1})):d("",!0),e.value.type==3?(s(),i(u,{key:6,label:"权限字符",name:"permission_mark"},{default:a(()=>[l(p,{modelValue:e.value.permission_mark,"onUpdate:modelValue":t[6]||(t[6]=n=>e.value.permission_mark=n)},null,8,["modelValue"])]),_:1})):d("",!0),e.value.type==1||e.value.type==3||e.value.type==2?(s(),i(u,{key:7,label:"显示排序",name:"sort"},{default:a(()=>[l(I,{modelValue:e.value.sort,"onUpdate:modelValue":t[7]||(t[7]=n=>e.value.sort=n)},null,8,["modelValue"])]),_:1})):d("",!0),e.value.type==2||e.value.type==1?(s(),i(u,{key:8,label:"页面状态",name:"hidden"},{default:a(()=>[l(U,{value:e.value.hidden,onChange:F},{default:a(()=>[l(v,{value:2},{default:a(()=>t[12]||(t[12]=[m("开启")])),_:1}),l(v,{value:1},{default:a(()=>t[13]||(t[13]=[m("关闭")])),_:1})]),_:1},8,["value"])]),_:1})):d("",!0),y("div",X,[y("div",Y,[y("div",Z,[l(h,{theme:"primary",class:"form-submit-confirm",type:"submit"},{default:a(()=>[m(q(x(D)("pages.formBase.confirm")),1)]),_:1}),l(h,{type:"reset",class:"form-submit-cancel",theme:"default",variant:"base"},{default:a(()=>[m(q(x(D)("pages.formBase.cancel")),1)]),_:1})])])])]),_:1},8,["data"])])]),_:1},8,["visible"])])}}});export{le as _};
