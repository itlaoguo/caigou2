import{l as N,aH as D,U as C,c1 as M,I as x,a0 as F,c2 as b,c3 as P,c4 as G,c5 as k,c6 as B,V as L,c7 as j,j as w,c8 as T,c9 as H,ca as I,R as U,av as O,aO as y,as as _,h as V}from"./installCanvasRenderer-jY-EmqBn.js";var z=function(){function a(e){this.coordSysDims=[],this.axisMap=C(),this.categoryAxisMap=C(),this.coordSysName=e}return a}();function W(a){var e=a.get("coordinateSystem"),t=new z(e),r=q[e];if(r)return r(a,t,t.axisMap,t.categoryAxisMap),t}var q={cartesian2d:function(a,e,t,r){var n=a.getReferringComponents("xAxis",D).models[0],i=a.getReferringComponents("yAxis",D).models[0];e.coordSysDims=["x","y"],t.set("x",n),t.set("y",i),h(n)&&(r.set("x",n),e.firstCategoryDimIndex=0),h(i)&&(r.set("y",i),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},singleAxis:function(a,e,t,r){var n=a.getReferringComponents("singleAxis",D).models[0];e.coordSysDims=["single"],t.set("single",n),h(n)&&(r.set("single",n),e.firstCategoryDimIndex=0)},polar:function(a,e,t,r){var n=a.getReferringComponents("polar",D).models[0],i=n.findAxisModel("radiusAxis"),s=n.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],t.set("radius",i),t.set("angle",s),h(i)&&(r.set("radius",i),e.firstCategoryDimIndex=0),h(s)&&(r.set("angle",s),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},geo:function(a,e,t,r){e.coordSysDims=["lng","lat"]},parallel:function(a,e,t,r){var n=a.ecModel,i=n.getComponent("parallel",a.get("parallelIndex")),s=e.coordSysDims=i.dimensions.slice();N(i.parallelAxisIndex,function(l,o){var u=n.getComponent("parallelAxis",l),f=s[o];t.set(f,u),h(u)&&(r.set(f,u),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=o))})}};function h(a){return a.get("type")==="category"}function J(a,e){var t=a.get("coordinateSystem"),r=B.get(t),n;return e&&e.coordSysDims&&(n=L(e.coordSysDims,function(i){var s={name:i},l=e.axisMap.get(i);if(l){var o=l.get("type");s.type=j(o)}return s})),n||(n=r&&(r.getDimensionsInfo?r.getDimensionsInfo():r.dimensions.slice())||["x","y"]),n}function K(a,e,t){var r,n;return t&&N(a,function(i,s){var l=i.coordDim,o=t.categoryAxisMap.get(l);o&&(r==null&&(r=s),i.ordinalMeta=o.getOrdinalMeta(),e&&(i.createInvertedIndices=!0)),i.otherDims.itemName!=null&&(n=!0)}),!n&&r!=null&&(a[r].otherDims.itemName=0),r}function te(a,e,t){t=t||{};var r=e.getSourceManager(),n,i=!1;a?(i=!0,n=H(a)):(n=r.getSource(),i=n.sourceFormat===M);var s=W(e),l=J(e,s),o=t.useEncodeDefaulter,u=x(o)?o:o?F(b,l,e):null,f={coordDimensions:l,generateCoord:t.generateCoord,encodeDefine:e.getEncode(),encodeDefaulter:u,canOmitUnusedDimensions:!i},c=P(n,f),d=K(c.dimensions,t.createInvertedIndices,s),g=i?null:r.getSharedDataStore(c),v=G(e,{schema:c,store:g}),m=new k(c,e);m.setCalculationInfo(v);var p=d!=null&&Q(n)?function(R,E,S,A){return A===d?S:this.defaultDimValueGetter(R,E,S,A)}:null;return m.hasItemOption=!1,m.initData(i?n:g,null,p),m}function Q(a){if(a.sourceFormat===M){var e=X(a.data||[]);return!w(T(e))}}function X(a){for(var e=0;e<a.length&&a[e]==null;)e++;return a[e]}function re(a,e){var t=a.mapDimensionsAll("defaultedLabel"),r=t.length;if(r===1){var n=I(a,e,t[0]);return n!=null?n+"":null}else if(r){for(var i=[],s=0;s<t.length;s++)i.push(I(a,e,t[s]));return i.join(" ")}}function ne(a,e){var t=a.mapDimensionsAll("defaultedLabel");if(!w(e))return e+"";for(var r=[],n=0;n<t.length;n++){var i=a.getDimensionIndex(t[n]);i>=0&&r.push(e[i])}return r.join(" ")}function Y(a,e,t,r,n){var i=a.getArea(),s=i.x,l=i.y,o=i.width,u=i.height,f=t.get(["lineStyle","width"])||2;s-=f/2,l-=f/2,o+=f,u+=f,s=Math.floor(s),o=Math.round(o);var c=new U({shape:{x:s,y:l,width:o,height:u}});if(e){var d=a.getBaseAxis(),g=d.isHorizontal(),v=d.inverse;g?(v&&(c.shape.x+=o),c.shape.width=0):(v||(c.shape.y+=u),c.shape.height=0);var m=x(n)?function(p){n(p,c)}:null;O(c,{shape:{width:o,height:u,x:s,y:l}},t,null,r,m)}return c}function Z(a,e,t){var r=a.getArea(),n=y(r.r0,1),i=y(r.r,1),s=new _({shape:{cx:y(a.cx,1),cy:y(a.cy,1),r0:n,r:i,startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}});if(e){var l=a.getBaseAxis().dim==="angle";l?s.shape.endAngle=r.startAngle:s.shape.r=n,O(s,{shape:{endAngle:r.endAngle,r:i}},t)}return s}function ie(a,e,t,r,n){if(a){if(a.type==="polar")return Z(a,e,t);if(a.type==="cartesian2d")return Y(a,e,t,r,n)}else return null;return null}function se(a,e){return a.type===e}var $={average:function(a){for(var e=0,t=0,r=0;r<a.length;r++)isNaN(a[r])||(e+=a[r],t++);return t===0?NaN:e/t},sum:function(a){for(var e=0,t=0;t<a.length;t++)e+=a[t]||0;return e},max:function(a){for(var e=-1/0,t=0;t<a.length;t++)a[t]>e&&(e=a[t]);return isFinite(e)?e:NaN},min:function(a){for(var e=1/0,t=0;t<a.length;t++)a[t]<e&&(e=a[t]);return isFinite(e)?e:NaN},nearest:function(a){return a[0]}},ee=function(a){return Math.round(a.length/2)};function oe(a){return{seriesType:a,reset:function(e,t,r){var n=e.getData(),i=e.get("sampling"),s=e.coordinateSystem,l=n.count();if(l>10&&s.type==="cartesian2d"&&i){var o=s.getBaseAxis(),u=s.getOtherAxis(o),f=o.getExtent(),c=r.getDevicePixelRatio(),d=Math.abs(f[1]-f[0])*(c||1),g=Math.round(l/d);if(isFinite(g)&&g>1){i==="lttb"&&e.setData(n.lttbDownSample(n.mapDimension(u.dim),1/g));var v=void 0;V(i)?v=$[i]:x(i)&&(v=i),v&&e.setData(n.downSample(n.mapDimension(u.dim),1/g,v,ee))}}}}}export{Y as a,Z as b,te as c,ne as d,oe as e,ie as f,re as g,se as i};
