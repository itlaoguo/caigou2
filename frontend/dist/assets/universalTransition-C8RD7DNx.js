import{ao as Yr,cq as k,V as j,cr as Hr,aK as Fr,ag as Q,cs as lr,ce as wr,as as Gr,R as zr,$ as X,ct as Br,an as B,al as kr,cu as sr,j as z,l as L,cv as F,cw as er,aB as br,U as tr,cc as _r,X as Er,av as ra,cx as aa,cy as na,O as Pr}from"./installCanvasRenderer-jY-EmqBn.js";var Z=Yr.CMD;function W(a,r){return Math.abs(a-r)<1e-5}function or(a){var r=a.data,t=a.len(),n=[],e,v=0,o=0,i=0,u=0;function d(m,A){e&&e.length>2&&n.push(e),e=[m,A]}function s(m,A,S,C){W(m,S)&&W(A,C)||e.push(m,A,S,C,S,C)}function f(m,A,S,C,q,O){var Y=Math.abs(A-m),N=Math.tan(Y/4)*4/3,V=A<m?-1:1,hr=Math.cos(m),gr=Math.sin(m),pr=Math.cos(A),Mr=Math.sin(A),Wr=hr*q+S,jr=gr*O+C,Ir=pr*q+S,Tr=Mr*O+C,yr=q*N*V,Dr=O*N*V;e.push(Wr-yr*gr,jr+Dr*hr,Ir+yr*Mr,Tr-Dr*pr,Ir,Tr)}for(var l,c,T,h,g=0;g<t;){var M=r[g++],y=g===1;switch(y&&(v=r[g],o=r[g+1],i=v,u=o,(M===Z.L||M===Z.C||M===Z.Q)&&(e=[i,u])),M){case Z.M:v=i=r[g++],o=u=r[g++],d(i,u);break;case Z.L:l=r[g++],c=r[g++],s(v,o,l,c),v=l,o=c;break;case Z.C:e.push(r[g++],r[g++],r[g++],r[g++],v=r[g++],o=r[g++]);break;case Z.Q:l=r[g++],c=r[g++],T=r[g++],h=r[g++],e.push(v+2/3*(l-v),o+2/3*(c-o),T+2/3*(l-T),h+2/3*(c-h),T,h),v=T,o=h;break;case Z.A:var p=r[g++],_=r[g++],D=r[g++],I=r[g++],G=r[g++],P=r[g++]+G;g+=1;var E=!r[g++];l=Math.cos(G)*D+p,c=Math.sin(G)*I+_,y?(i=l,u=c,d(i,u)):s(v,o,l,c),v=Math.cos(P)*D+p,o=Math.sin(P)*I+_;for(var R=(E?-1:1)*Math.PI/2,x=G;E?x>P:x<P;x+=R){var U=E?Math.max(x+R,P):Math.min(x+R,P);f(x,U,p,_,D,I)}break;case Z.R:i=v=r[g++],u=o=r[g++],l=i+r[g++],c=u+r[g++],d(l,u),s(l,u,l,c),s(l,c,i,c),s(i,c,i,u),s(i,u,l,u);break;case Z.Z:e&&s(v,o,i,u),v=i,o=u;break}}return e&&e.length>2&&n.push(e),n}function ur(a,r,t,n,e,v,o,i,u,d){if(W(a,t)&&W(r,n)&&W(e,o)&&W(v,i)){u.push(o,i);return}var s=2/d,f=s*s,l=o-a,c=i-r,T=Math.sqrt(l*l+c*c);l/=T,c/=T;var h=t-a,g=n-r,M=e-o,y=v-i,p=h*h+g*g,_=M*M+y*y;if(p<f&&_<f){u.push(o,i);return}var D=l*h+c*g,I=-l*M-c*y,G=p-D*D,P=_-I*I;if(G<f&&D>=0&&P<f&&I>=0){u.push(o,i);return}var E=[],R=[];k(a,t,e,o,.5,E),k(r,n,v,i,.5,R),ur(E[0],R[0],E[1],R[1],E[2],R[2],E[3],R[3],u,d),ur(E[4],R[4],E[5],R[5],E[6],R[6],E[7],R[7],u,d)}function ea(a,r){var t=or(a),n=[];r=r||1;for(var e=0;e<t.length;e++){var v=t[e],o=[],i=v[0],u=v[1];o.push(i,u);for(var d=2;d<v.length;){var s=v[d++],f=v[d++],l=v[d++],c=v[d++],T=v[d++],h=v[d++];ur(i,u,s,f,l,c,T,h,o,r),i=T,u=h}n.push(o)}return n}function Vr(a,r,t){var n=a[r],e=a[1-r],v=Math.abs(n/e),o=Math.ceil(Math.sqrt(v*t)),i=Math.floor(t/o);i===0&&(i=1,o=t);for(var u=[],d=0;d<o;d++)u.push(i);var s=o*i,f=t-s;if(f>0)for(var d=0;d<f;d++)u[d%o]+=1;return u}function Rr(a,r,t){for(var n=a.r0,e=a.r,v=a.startAngle,o=a.endAngle,i=Math.abs(o-v),u=i*e,d=e-n,s=u>Math.abs(d),f=Vr([u,d],s?0:1,r),l=(s?i:d)/f.length,c=0;c<f.length;c++)for(var T=(s?d:i)/f[c],h=0;h<f[c];h++){var g={};s?(g.startAngle=v+l*c,g.endAngle=v+l*(c+1),g.r0=n+T*h,g.r=n+T*(h+1)):(g.startAngle=v+T*h,g.endAngle=v+T*(h+1),g.r0=n+l*c,g.r=n+l*(c+1)),g.clockwise=a.clockwise,g.cx=a.cx,g.cy=a.cy,t.push(g)}}function ta(a,r,t){for(var n=a.width,e=a.height,v=n>e,o=Vr([n,e],v?0:1,r),i=v?"width":"height",u=v?"height":"width",d=v?"x":"y",s=v?"y":"x",f=a[i]/o.length,l=0;l<o.length;l++)for(var c=a[u]/o[l],T=0;T<o[l];T++){var h={};h[d]=l*f,h[s]=T*c,h[i]=f,h[u]=c,h.x+=a.x,h.y+=a.y,t.push(h)}}function Cr(a,r,t,n){return a*n-t*r}function va(a,r,t,n,e,v,o,i){var u=t-a,d=n-r,s=o-e,f=i-v,l=Cr(s,f,u,d);if(Math.abs(l)<1e-6)return null;var c=a-e,T=r-v,h=Cr(c,T,s,f)/l;return h<0||h>1?null:new Q(h*u+a,h*d+r)}function ia(a,r,t){var n=new Q;Q.sub(n,t,r),n.normalize();var e=new Q;Q.sub(e,a,r);var v=e.dot(n);return v}function $(a,r){var t=a[a.length-1];t&&t[0]===r[0]&&t[1]===r[1]||a.push(r)}function da(a,r,t){for(var n=a.length,e=[],v=0;v<n;v++){var o=a[v],i=a[(v+1)%n],u=va(o[0],o[1],i[0],i[1],r.x,r.y,t.x,t.y);u&&e.push({projPt:ia(u,r,t),pt:u,idx:v})}if(e.length<2)return[{points:a},{points:a}];e.sort(function(g,M){return g.projPt-M.projPt});var d=e[0],s=e[e.length-1];if(s.idx<d.idx){var f=d;d=s,s=f}for(var l=[d.pt.x,d.pt.y],c=[s.pt.x,s.pt.y],T=[l],h=[c],v=d.idx+1;v<=s.idx;v++)$(T,a[v].slice());$(T,c),$(T,l);for(var v=s.idx+1;v<=d.idx+n;v++)$(h,a[v%n].slice());return $(h,l),$(h,c),[{points:T},{points:h}]}function mr(a){var r=a.points,t=[],n=[];Hr(r,t,n);var e=new Fr(t[0],t[1],n[0]-t[0],n[1]-t[1]),v=e.width,o=e.height,i=e.x,u=e.y,d=new Q,s=new Q;return v>o?(d.x=s.x=i+v/2,d.y=u,s.y=u+o):(d.y=s.y=u+o/2,d.x=i,s.x=i+v),da(r,d,s)}function b(a,r,t,n){if(t===1)n.push(r);else{var e=Math.floor(t/2),v=a(r);b(a,v[0],e,n),b(a,v[1],t-e,n)}return n}function oa(a,r){for(var t=[],n=0;n<r;n++)t.push(lr(a));return t}function ua(a,r){r.setStyle(a.style),r.z=a.z,r.z2=a.z2,r.zlevel=a.zlevel}function fa(a){for(var r=[],t=0;t<a.length;)r.push([a[t++],a[t++]]);return r}function la(a,r){var t=[],n=a.shape,e;switch(a.type){case"rect":ta(n,r,t),e=zr;break;case"sector":Rr(n,r,t),e=Gr;break;case"circle":Rr({r0:0,r:n.r,startAngle:0,endAngle:Math.PI*2,cx:n.cx,cy:n.cy},r,t),e=Gr;break;default:var v=a.getComputedTransform(),o=v?Math.sqrt(Math.max(v[0]*v[0]+v[1]*v[1],v[2]*v[2]+v[3]*v[3])):1,i=j(ea(a.getUpdatedPathProxy(),o),function(M){return fa(M)}),u=i.length;if(u===0)b(mr,{points:i[0]},r,t);else if(u===r)for(var d=0;d<u;d++)t.push({points:i[d]});else{var s=0,f=j(i,function(M){var y=[],p=[];Hr(M,y,p);var _=(p[1]-y[1])*(p[0]-y[0]);return s+=_,{poly:M,area:_}});f.sort(function(M,y){return y.area-M.area});for(var l=r,d=0;d<u;d++){var c=f[d];if(l<=0)break;var T=d===u-1?l:Math.ceil(c.area/s*r);T<0||(b(mr,{points:c.poly},T,t),l-=T)}}e=wr;break}if(!e)return oa(a,r);for(var h=[],d=0;d<t.length;d++){var g=new e;g.setShape(t[d]),ua(a,g),h.push(g)}return h}function sa(a,r){var t=a.length,n=r.length;if(t===n)return[a,r];for(var e=[],v=[],o=t<n?a:r,i=Math.min(t,n),u=Math.abs(n-t)/6,d=(i-2)/6,s=Math.ceil(u/d)+1,f=[o[0],o[1]],l=u,c=2;c<i;){var T=o[c-2],h=o[c-1],g=o[c++],M=o[c++],y=o[c++],p=o[c++],_=o[c++],D=o[c++];if(l<=0){f.push(g,M,y,p,_,D);continue}for(var I=Math.min(l,s-1)+1,G=1;G<=I;G++){var P=G/I;k(T,g,y,_,P,e),k(h,M,p,D,P,v),T=e[3],h=v[3],f.push(e[1],v[1],e[2],v[2],T,h),g=e[5],M=v[5],y=e[6],p=v[6]}l-=I-1}return o===a?[f,r]:[a,f]}function xr(a,r){for(var t=a.length,n=a[t-2],e=a[t-1],v=[],o=0;o<r.length;)v[o++]=n,v[o++]=e;return v}function ca(a,r){for(var t,n,e,v=[],o=[],i=0;i<Math.max(a.length,r.length);i++){var u=a[i],d=r[i],s=void 0,f=void 0;u?d?(t=sa(u,d),s=t[0],f=t[1],n=s,e=f):(f=xr(e||u,u),s=u):(s=xr(n||d,d),f=d),v.push(s),o.push(f)}return[v,o]}function Ar(a){for(var r=0,t=0,n=0,e=a.length,v=0,o=e-2;v<e;o=v,v+=2){var i=a[o],u=a[o+1],d=a[v],s=a[v+1],f=i*s-d*u;r+=f,t+=(i+d)*f,n+=(u+s)*f}return r===0?[a[0]||0,a[1]||0]:[t/r/3,n/r/3,r]}function ha(a,r,t,n){for(var e=(a.length-2)/6,v=1/0,o=0,i=a.length,u=i-2,d=0;d<e;d++){for(var s=d*6,f=0,l=0;l<i;l+=2){var c=l===0?s:(s+l-2)%u+2,T=a[c]-t[0],h=a[c+1]-t[1],g=r[l]-n[0],M=r[l+1]-n[1],y=g-T,p=M-h;f+=y*y+p*p}f<v&&(v=f,o=d)}return o}function ga(a){for(var r=[],t=a.length,n=0;n<t;n+=2)r[n]=a[t-n-2],r[n+1]=a[t-n-1];return r}function pa(a,r,t,n){for(var e=[],v,o=0;o<a.length;o++){var i=a[o],u=r[o],d=Ar(i),s=Ar(u);v==null&&(v=d[2]<0!=s[2]<0);var f=[],l=[],c=0,T=1/0,h=[],g=i.length;v&&(i=ga(i));for(var M=ha(i,u,d,s)*6,y=g-2,p=0;p<y;p+=2){var _=(M+p)%y+2;f[p+2]=i[_]-d[0],f[p+3]=i[_+1]-d[1]}f[0]=i[M]-d[0],f[1]=i[M+1]-d[1];for(var D=n/t,I=-n/2;I<=n/2;I+=D){for(var G=Math.sin(I),P=Math.cos(I),E=0,p=0;p<i.length;p+=2){var R=f[p],x=f[p+1],U=u[p]-s[0],m=u[p+1]-s[1],A=U*P-m*G,S=U*G+m*P;h[p]=A,h[p+1]=S;var C=A-R,q=S-x;E+=C*C+q*q}if(E<T){T=E,c=I;for(var O=0;O<h.length;O++)l[O]=h[O]}}e.push({from:f,to:l,fromCp:d,toCp:s,rotation:-c})}return e}function rr(a){return a.__isCombineMorphing}var Kr="__mOriginal_";function ar(a,r,t){var n=Kr+r,e=a[n]||a[r];a[n]||(a[n]=a[r]);var v=t.replace,o=t.after,i=t.before;a[r]=function(){var u=arguments,d;return i&&i.apply(this,u),v?d=v.apply(this,u):d=e.apply(this,u),o&&o.apply(this,u),d}}function w(a,r){var t=Kr+r;a[t]&&(a[r]=a[t],a[t]=null)}function Lr(a,r){for(var t=0;t<a.length;t++)for(var n=a[t],e=0;e<n.length;){var v=n[e],o=n[e+1];n[e++]=r[0]*v+r[2]*o+r[4],n[e++]=r[1]*v+r[3]*o+r[5]}}function Qr(a,r){var t=a.getUpdatedPathProxy(),n=r.getUpdatedPathProxy(),e=ca(or(t),or(n)),v=e[0],o=e[1],i=a.getComputedTransform(),u=r.getComputedTransform();function d(){this.transform=null}i&&Lr(v,i),u&&Lr(o,u),ar(r,"updateTransform",{replace:d}),r.transform=null;var s=pa(v,o,10,Math.PI),f=[];ar(r,"buildPath",{replace:function(l){for(var c=r.__morphT,T=1-c,h=[],g=0;g<s.length;g++){var M=s[g],y=M.from,p=M.to,_=M.rotation*c,D=M.fromCp,I=M.toCp,G=Math.sin(_),P=Math.cos(_);kr(h,D,I,c);for(var E=0;E<y.length;E+=2){var R=y[E],x=y[E+1],U=p[E],m=p[E+1],A=R*T+U*c,S=x*T+m*c;f[E]=A*P-S*G+h[0],f[E+1]=A*G+S*P+h[1]}var C=f[0],q=f[1];l.moveTo(C,q);for(var E=2;E<y.length;){var U=f[E++],m=f[E++],O=f[E++],Y=f[E++],N=f[E++],V=f[E++];C===U&&q===m&&O===N&&Y===V?l.lineTo(N,V):l.bezierCurveTo(U,m,O,Y,N,V),C=N,q=V}}}})}function cr(a,r,t){if(!a||!r)return r;var n=t.done,e=t.during;Qr(a,r),r.__morphT=0;function v(){w(r,"buildPath"),w(r,"updateTransform"),r.__morphT=-1,r.createPathProxy(),r.dirtyShape()}return r.animateTo({__morphT:1},X({during:function(o){r.dirtyShape(),e&&e(o)},done:function(){v(),n&&n()}},t)),r}function Ma(a,r,t,n,e,v){var o=16;a=e===t?0:Math.round(32767*(a-t)/(e-t)),r=v===n?0:Math.round(32767*(r-n)/(v-n));for(var i=0,u,d=(1<<o)/2;d>0;d/=2){var s=0,f=0;(a&d)>0&&(s=1),(r&d)>0&&(f=1),i+=d*d*(3*s^f),f===0&&(s===1&&(a=d-1-a,r=d-1-r),u=a,a=r,r=u)}return i}function nr(a){var r=1/0,t=1/0,n=-1/0,e=-1/0,v=j(a,function(i){var u=i.getBoundingRect(),d=i.getComputedTransform(),s=u.x+u.width/2+(d?d[4]:0),f=u.y+u.height/2+(d?d[5]:0);return r=Math.min(s,r),t=Math.min(f,t),n=Math.max(s,n),e=Math.max(f,e),[s,f]}),o=j(v,function(i,u){return{cp:i,z:Ma(i[0],i[1],r,t,n,e),path:a[u]}});return o.sort(function(i,u){return i.z-u.z}).map(function(i){return i.path})}function Xr(a){return la(a.path,a.count)}function fr(){return{fromIndividuals:[],toIndividuals:[],count:0}}function Ia(a,r,t){var n=[];function e(D){for(var I=0;I<D.length;I++){var G=D[I];rr(G)?e(G.childrenRef()):G instanceof B&&n.push(G)}}e(a);var v=n.length;if(!v)return fr();var o=t.dividePath||Xr,i=o({path:r,count:v});if(i.length!==v)return console.error("Invalid morphing: unmatched splitted path"),fr();n=nr(n),i=nr(i);for(var u=t.done,d=t.during,s=t.individualDelay,f=new Br,l=0;l<v;l++){var c=n[l],T=i[l];T.parent=r,T.copyTransform(f),s||Qr(c,T)}r.__isCombineMorphing=!0,r.childrenRef=function(){return i};function h(D){for(var I=0;I<i.length;I++)i[I].addSelfToZr(D)}ar(r,"addSelfToZr",{after:function(D){h(D)}}),ar(r,"removeSelfFromZr",{after:function(D){for(var I=0;I<i.length;I++)i[I].removeSelfFromZr(D)}});function g(){r.__isCombineMorphing=!1,r.__morphT=-1,r.childrenRef=null,w(r,"addSelfToZr"),w(r,"removeSelfFromZr")}var M=i.length;if(s)for(var y=M,p=function(){y--,y===0&&(g(),u&&u())},l=0;l<M;l++){var _=s?X({delay:(t.delay||0)+s(l,M,n[l],i[l]),done:p},t):t;cr(n[l],i[l],_)}else r.__morphT=0,r.animateTo({__morphT:1},X({during:function(D){for(var I=0;I<M;I++){var G=i[I];G.__morphT=r.__morphT,G.dirtyShape()}d&&d(D)},done:function(){g();for(var D=0;D<a.length;D++)w(a[D],"updateTransform");u&&u()}},t));return r.__zr&&h(r.__zr),{fromIndividuals:n,toIndividuals:i,count:M}}function Ta(a,r,t){var n=r.length,e=[],v=t.dividePath||Xr;function o(c){for(var T=0;T<c.length;T++){var h=c[T];rr(h)?o(h.childrenRef()):h instanceof B&&e.push(h)}}if(rr(a)){o(a.childrenRef());var i=e.length;if(i<n)for(var u=0,d=i;d<n;d++)e.push(lr(e[u++%i]));e.length=n}else{e=v({path:a,count:n});for(var s=a.getComputedTransform(),d=0;d<e.length;d++)e[d].setLocalTransform(s);if(e.length!==n)return console.error("Invalid morphing: unmatched splitted path"),fr()}e=nr(e),r=nr(r);for(var f=t.individualDelay,d=0;d<n;d++){var l=f?X({delay:(t.delay||0)+f(d,n,e[d],r[d])},t):t;cr(e[d],r[d],l)}return{fromIndividuals:e,toIndividuals:r,count:r.length}}function Sr(a){return z(a[0])}function Ur(a,r){for(var t=[],n=a.length,e=0;e<n;e++)t.push({one:a[e],many:[]});for(var e=0;e<r.length;e++){var v=r[e].length,o=void 0;for(o=0;o<v;o++)t[o%n].many.push(r[e][o])}for(var i=0,e=n-1;e>=0;e--)if(!t[e].many.length){var u=t[i].many;if(u.length<=1)if(i)i=0;else return t;var v=u.length,d=Math.ceil(v/2);t[e].many=u.slice(d,v),t[i].many=u.slice(0,d),i++}return t}var ya={clone:function(a){for(var r=[],t=1-Math.pow(1-a.path.style.opacity,1/a.count),n=0;n<a.count;n++){var e=lr(a.path);e.setStyle("opacity",t),r.push(e)}return r},split:null};function vr(a,r,t,n,e,v){if(!a.length||!r.length)return;var o=sr("update",n,e);if(!(o&&o.duration>0))return;var i=n.getModel("universalTransition").get("delay"),u=Object.assign({setToFinal:!0},o),d,s;Sr(a)&&(d=a,s=r),Sr(r)&&(d=r,s=a);function f(M,y,p,_,D){var I=M.many,G=M.one;if(I.length===1&&!D){var P=y?I[0]:G,E=y?G:I[0];if(rr(P))f({many:[P],one:E},!0,p,_,!0);else{var R=i?X({delay:i(p,_)},u):u;cr(P,E,R),v(P,E,P,E,R)}}else for(var x=X({dividePath:ya[t],individualDelay:i&&function(q,O,Y,N){return i(q+p,_)}},u),U=y?Ia(I,G,x):Ta(G,I,x),m=U.fromIndividuals,A=U.toIndividuals,S=m.length,C=0;C<S;C++){var R=i?X({delay:i(C,S)},u):u;v(m[C],A[C],y?I[C]:M.one,y?M.one:I[C],R)}}for(var l=d?d===a:a.length>r.length,c=d?Ur(s,d):Ur(l?r:a,[l?a:r]),T=0,h=0;h<c.length;h++)T+=c[h].many.length;for(var g=0,h=0;h<c.length;h++)f(c[h],l,g,T),g+=c[h].many.length}function K(a){if(!a)return[];if(z(a)){for(var r=[],t=0;t<a.length;t++)r.push(K(a[t]));return r}var n=[];return a.traverse(function(e){e instanceof B&&!e.disableMorphing&&!e.invisible&&!e.ignore&&n.push(e)}),n}var $r=1e4,Da=br();function Ga(a){for(var r=a.dimensions,t=0;t<r.length;t++){var n=a.getDimensionInfo(r[t]);if(n&&n.otherDims.itemGroupId===0)return r[t]}}function qr(a){var r=[];return L(a,function(t){var n=t.data;if(!(n.count()>$r))for(var e=n.getIndices(),v=Ga(n),o=0;o<e.length;o++)r.push({dataGroupId:t.dataGroupId,data:n,dim:t.dim||v,divide:t.divide,dataIndex:o})}),r}function ir(a,r,t){a.traverse(function(n){n instanceof B&&ra(n,{style:{opacity:0}},r,{dataIndex:t,isFrom:!0})})}function dr(a){if(a.parent){var r=a.getComputedTransform();a.setLocalTransform(r),a.parent.remove(a)}}function J(a){a.stopAnimation(),a.isGroup&&a.traverse(function(r){r.stopAnimation()})}function _a(a,r,t){var n=sr("update",t,r);n&&a.traverse(function(e){if(e instanceof aa){var v=na(e);v&&e.animateFrom({style:v},n)}})}function Ea(a,r){var t=a.length;if(t!==r.length)return!1;for(var n=0;n<t;n++){var e=a[n],v=r[n];if(e.data.getId(e.dataIndex)!==v.data.getId(v.dataIndex))return!1}return!0}function Jr(a,r,t){var n=qr(a),e=qr(r);function v(M,y,p,_,D){(p||M)&&y.animateFrom({style:p&&p!==M?Pr(Pr({},p.style),M.style):M.style},D)}function o(M){for(var y=0;y<M.length;y++)if(M[y].dim)return M[y].dim}var i=o(n),u=o(e),d=!1;function s(M,y){return function(p){var _=p.data,D=p.dataIndex;if(y)return _.getId(D);var I=p.dataGroupId,G=M?i||u:u||i,P=G&&_.getDimensionInfo(G),E=P&&P.ordinalMeta;if(P){var R=_.get(P.name,D);return E&&E.categories[R]||R+""}var x=_.getRawDataItem(D);return x&&x.groupId?x.groupId+"":I||_.getId(D)}}var f=Ea(n,e),l={};if(!f)for(var c=0;c<e.length;c++){var T=e[c],h=T.data.getItemGraphicEl(T.dataIndex);h&&(l[h.id]=!0)}function g(M,y){var p=n[y],_=e[M],D=_.data.hostModel,I=p.data.getItemGraphicEl(p.dataIndex),G=_.data.getItemGraphicEl(_.dataIndex);if(I===G){G&&_a(G,_.dataIndex,D);return}I&&l[I.id]||G&&(J(G),I?(J(I),dr(I),d=!0,vr(K(I),K(G),_.divide,D,M,v)):ir(G,D,M))}new _r(n,e,s(!0,f),s(!1,f),null,"multiple").update(g).updateManyToOne(function(M,y){var p=e[M],_=p.data,D=_.hostModel,I=_.getItemGraphicEl(p.dataIndex),G=Er(j(y,function(P){return n[P].data.getItemGraphicEl(n[P].dataIndex)}),function(P){return P&&P!==I&&!l[P.id]});I&&(J(I),G.length?(L(G,function(P){J(P),dr(P)}),d=!0,vr(K(G),K(I),p.divide,D,M,v)):ir(I,D,p.dataIndex))}).updateOneToMany(function(M,y){var p=n[y],_=p.data.getItemGraphicEl(p.dataIndex);if(!(_&&l[_.id])){var D=Er(j(M,function(G){return e[G].data.getItemGraphicEl(e[G].dataIndex)}),function(G){return G&&G!==_}),I=e[M[0]].data.hostModel;D.length&&(L(D,function(G){return J(G)}),_?(J(_),dr(_),d=!0,vr(K(_),K(D),p.divide,I,M[0],v)):L(D,function(G){return ir(G,I,M[0])}))}}).updateManyToMany(function(M,y){new _r(y,M,function(p){return n[p].data.getId(n[p].dataIndex)},function(p){return e[p].data.getId(e[p].dataIndex)}).update(function(p,_){g(M[p],y[_])}).execute()}).execute(),d&&L(r,function(M){var y=M.data,p=y.hostModel,_=p&&t.getViewOfSeriesModel(p),D=sr("update",p,0);_&&p.isAnimationEnabled()&&D&&D.duration>0&&_.group.traverse(function(I){I instanceof B&&!I.animators.length&&I.animateFrom({style:{opacity:0}},D)})})}function Or(a){var r=a.getModel("universalTransition").get("seriesKey");return r||a.id}function Zr(a){return z(a)?a.sort().join(","):a}function H(a){if(a.hostModel)return a.hostModel.getModel("universalTransition").get("divideShape")}function Pa(a,r){var t=tr(),n=tr(),e=tr();return L(a.oldSeries,function(v,o){var i=a.oldDataGroupIds[o],u=a.oldData[o],d=Or(v),s=Zr(d);n.set(s,{dataGroupId:i,data:u}),z(d)&&L(d,function(f){e.set(f,{key:s,dataGroupId:i,data:u})})}),L(r.updatedSeries,function(v){if(v.isUniversalTransitionEnabled()&&v.isAnimationEnabled()){var o=v.get("dataGroupId"),i=v.getData(),u=Or(v),d=Zr(u),s=n.get(d);if(s)t.set(d,{oldSeries:[{dataGroupId:s.dataGroupId,divide:H(s.data),data:s.data}],newSeries:[{dataGroupId:o,divide:H(i),data:i}]});else if(z(u)){var f=[];L(u,function(T){var h=n.get(T);h.data&&f.push({dataGroupId:h.dataGroupId,divide:H(h.data),data:h.data})}),f.length&&t.set(d,{oldSeries:f,newSeries:[{dataGroupId:o,data:i,divide:H(i)}]})}else{var l=e.get(u);if(l){var c=t.get(l.key);c||(c={oldSeries:[{dataGroupId:l.dataGroupId,data:l.data,divide:H(l.data)}],newSeries:[]},t.set(l.key,c)),c.newSeries.push({dataGroupId:o,data:i,divide:H(i)})}}}}),t}function Nr(a,r){for(var t=0;t<a.length;t++){var n=r.seriesIndex!=null&&r.seriesIndex===a[t].seriesIndex||r.seriesId!=null&&r.seriesId===a[t].id;if(n)return t}}function Ra(a,r,t,n){var e=[],v=[];L(F(a.from),function(o){var i=Nr(r.oldSeries,o);i>=0&&e.push({dataGroupId:r.oldDataGroupIds[i],data:r.oldData[i],divide:H(r.oldData[i]),dim:o.dimension})}),L(F(a.to),function(o){var i=Nr(t.updatedSeries,o);if(i>=0){var u=t.updatedSeries[i].getData();v.push({dataGroupId:r.oldDataGroupIds[i],data:u,divide:H(u),dim:o.dimension})}}),e.length>0&&v.length>0&&Jr(e,v,n)}function ma(a){a.registerUpdateLifecycle("series:beforeupdate",function(r,t,n){L(F(n.seriesTransition),function(e){L(F(e.to),function(v){for(var o=n.updatedSeries,i=0;i<o.length;i++)(v.seriesIndex!=null&&v.seriesIndex===o[i].seriesIndex||v.seriesId!=null&&v.seriesId===o[i].id)&&(o[i][er]=!0)})})}),a.registerUpdateLifecycle("series:transition",function(r,t,n){var e=Da(t);if(e.oldSeries&&n.updatedSeries&&n.optionChanged){var v=n.seriesTransition;if(v)L(F(v),function(c){Ra(c,e,n,t)});else{var o=Pa(e,n);L(o.keys(),function(c){var T=o.get(c);Jr(T.oldSeries,T.newSeries,t)})}L(n.updatedSeries,function(c){c[er]&&(c[er]=!1)})}for(var i=r.getSeries(),u=e.oldSeries=[],d=e.oldDataGroupIds=[],s=e.oldData=[],f=0;f<i.length;f++){var l=i[f].getData();l.count()<$r&&(u.push(i[f]),d.push(i[f].get("dataGroupId")),s.push(l))}})}export{ma as i};
