import{_ as V,m as T,$ as Yt,F as A,cA as Be,bZ as te,cd as Rr,h as Z,aP as ke,Y as D,R as re,cB as ae,cC as Dr,cD as Cr,aW as Ut,ai as Xt,ce as Ne,cE as Lr,aR as Gr,cF as Bt,cG as Ar,b6 as Zt,l as d,V as E,B as Pr,bW as Pe,bV as Fr,cH as Or,b_ as zr,c0 as Jt,cI as Ze,bU as Er,am as Wt,aL as ie,aK as k,cJ as $t,cK as jt,U as x,cL as Kt,X as Hr,ck as kr,aB as Nr,ae as Yr,cM as Ur,cx as Je,cN as qt,O as ne,a7 as Xr,a3 as Qt,az as er,y as ve,a6 as Br,ay as Zr,cO as Jr,cP as Wr,b3 as $r,au as jr,a0 as Kr,aF as qr,A as We,a8 as ge,aE as Qr,ct as se,J as Q,cQ as ea,cR as ta,ad as ra,aI as aa,aH as ia,cS as na,bS as tr,g as rr,aD as oa,cT as sa,N as $e,I as ar,C as ir,z as nr,K as or,u as Fe,aG as la,r as X,j as O,a2 as be,cU as we,P as ua,af as B,a1 as ca,cV as pa,cW as Te,cX as sr,cY as lr,cv as fa,cj as ur,Q as je,aa as cr,n as ha,p as va,Z as ee,a5 as pe,bM as Ke,cZ as ga,b$ as xe,cg as Ve,c_ as da,cf as ya,c$ as ma,d0 as qe,b as _a}from"./installCanvasRenderer-jY-EmqBn.js";import{b as Qe,o as Sa,s as Ma}from"./install-C6E25Ezf.js";import{c as ba}from"./createSeriesDataSimply-CNnRpMCT.js";var wa=function(n){V(r,n);function r(e){var t=n.call(this)||this;t._zr=e;var a=T(t._mousedownHandler,t),i=T(t._mousemoveHandler,t),o=T(t._mouseupHandler,t),s=T(t._mousewheelHandler,t),l=T(t._pinchHandler,t);return t.enable=function(u,p){this.disable(),this._opt=Yt(A(p)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),u==null&&(u=!0),(u===!0||u==="move"||u==="pan")&&(e.on("mousedown",a),e.on("mousemove",i),e.on("mouseup",o)),(u===!0||u==="scale"||u==="zoom")&&(e.on("mousewheel",s),e.on("pinch",l))},t.disable=function(){e.off("mousedown",a),e.off("mousemove",i),e.off("mouseup",o),e.off("mousewheel",s),e.off("pinch",l)},t}return r.prototype.isDragging=function(){return this._dragging},r.prototype.isPinching=function(){return this._pinching},r.prototype.setPointerChecker=function(e){this.pointerChecker=e},r.prototype.dispose=function(){this.disable()},r.prototype._mousedownHandler=function(e){if(!Be(e)){for(var t=e.target;t;){if(t.draggable)return;t=t.__hostTarget||t.parent}var a=e.offsetX,i=e.offsetY;this.pointerChecker&&this.pointerChecker(e,a,i)&&(this._x=a,this._y=i,this._dragging=!0)}},r.prototype._mousemoveHandler=function(e){if(!(!this._dragging||!fe("moveOnMouseMove",e,this._opt)||e.gestureEvent==="pinch"||Qe(this._zr,"globalPan"))){var t=e.offsetX,a=e.offsetY,i=this._x,o=this._y,s=t-i,l=a-o;this._x=t,this._y=a,this._opt.preventDefaultMouseMove&&te(e.event),pr(this,"pan","moveOnMouseMove",e,{dx:s,dy:l,oldX:i,oldY:o,newX:t,newY:a,isAvailableBehavior:null})}},r.prototype._mouseupHandler=function(e){Be(e)||(this._dragging=!1)},r.prototype._mousewheelHandler=function(e){var t=fe("zoomOnMouseWheel",e,this._opt),a=fe("moveOnMouseWheel",e,this._opt),i=e.wheelDelta,o=Math.abs(i),s=e.offsetX,l=e.offsetY;if(!(i===0||!t&&!a)){if(t){var u=o>3?1.4:o>1?1.2:1.1,p=i>0?u:1/u;Ie(this,"zoom","zoomOnMouseWheel",e,{scale:p,originX:s,originY:l,isAvailableBehavior:null})}if(a){var c=Math.abs(i),h=(i>0?1:-1)*(c>3?.4:c>1?.15:.05);Ie(this,"scrollMove","moveOnMouseWheel",e,{scrollDelta:h,originX:s,originY:l,isAvailableBehavior:null})}}},r.prototype._pinchHandler=function(e){if(!Qe(this._zr,"globalPan")){var t=e.pinchScale>1?1.1:1/1.1;Ie(this,"zoom",null,e,{scale:t,originX:e.pinchX,originY:e.pinchY,isAvailableBehavior:null})}},r}(Rr);function Ie(n,r,e,t,a){n.pointerChecker&&n.pointerChecker(t,a.originX,a.originY)&&(te(t.event),pr(n,r,e,t,a))}function pr(n,r,e,t,a){a.isAvailableBehavior=T(fe,null,e,t),n.trigger(r,a)}function fe(n,r,e){var t=e[n];return!n||t&&(!Z(t)||r.event[t+"Key"])}function Ta(n,r,e){var t=n.target;t.x+=r,t.y+=e,t.dirty()}function xa(n,r,e,t){var a=n.target,i=n.zoomLimit,o=n.zoom=n.zoom||1;if(o*=r,i){var s=i.min||0,l=i.max||1/0;o=Math.max(Math.min(l,o),s)}var u=o/n.zoom;n.zoom=o,a.x-=(e-a.x)*(u-1),a.y-=(t-a.y)*(u-1),a.scaleX*=u,a.scaleY*=u,a.dirty()}function fr(n){if(Z(n)){var r=new DOMParser;n=r.parseFromString(n,"text/xml")}var e=n;for(e.nodeType===9&&(e=e.firstChild);e.nodeName.toLowerCase()!=="svg"||e.nodeType!==1;)e=e.nextSibling;return e}var Re,de={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-anchor":"textAlign",visibility:"visibility",display:"display"},et=ke(de),ye={"alignment-baseline":"textBaseline","stop-color":"stopColor"},tt=ke(ye),Va=function(){function n(){this._defs={},this._root=null}return n.prototype.parse=function(r,e){e=e||{};var t=fr(r);this._defsUsePending=[];var a=new D;this._root=a;var i=[],o=t.getAttribute("viewBox")||"",s=parseFloat(t.getAttribute("width")||e.width),l=parseFloat(t.getAttribute("height")||e.height);isNaN(s)&&(s=null),isNaN(l)&&(l=null),L(t,a,null,!0,!1);for(var u=t.firstChild;u;)this._parseNode(u,a,i,null,!1,!1),u=u.nextSibling;Da(this._defs,this._defsUsePending),this._defsUsePending=[];var p,c;if(o){var h=Se(o);h.length>=4&&(p={x:parseFloat(h[0]||0),y:parseFloat(h[1]||0),width:parseFloat(h[2]),height:parseFloat(h[3])})}if(p&&s!=null&&l!=null&&(c=vr(p,{x:0,y:0,width:s,height:l}),!e.ignoreViewBox)){var f=a;a=new D,a.add(f),f.scaleX=f.scaleY=c.scale,f.x=c.x,f.y=c.y}return!e.ignoreRootClip&&s!=null&&l!=null&&a.setClipPath(new re({shape:{x:0,y:0,width:s,height:l}})),{root:a,width:s,height:l,viewBoxRect:p,viewBoxTransform:c,named:i}},n.prototype._parseNode=function(r,e,t,a,i,o){var s=r.nodeName.toLowerCase(),l,u=a;if(s==="defs"&&(i=!0),s==="text"&&(o=!0),s==="defs"||s==="switch")l=e;else{if(!i){var p=Re[s];if(p&&ae(Re,s)){l=p.call(this,r,e);var c=r.getAttribute("name");if(c){var h={name:c,namedFrom:null,svgNodeTagLower:s,el:l};t.push(h),s==="g"&&(u=h)}else a&&t.push({name:a.name,namedFrom:a,svgNodeTagLower:s,el:l});e.add(l)}}var f=rt[s];if(f&&ae(rt,s)){var v=f.call(this,r),g=r.getAttribute("id");g&&(this._defs[g]=v)}}if(l&&l.isGroup)for(var y=r.firstChild;y;)y.nodeType===1?this._parseNode(y,l,t,u,i,o):y.nodeType===3&&o&&this._parseText(y,l),y=y.nextSibling},n.prototype._parseText=function(r,e){var t=new Dr({style:{text:r.textContent},silent:!0,x:this._textX||0,y:this._textY||0});G(e,t),L(r,t,this._defsUsePending,!1,!1),Ia(t,e);var a=t.style,i=a.fontSize;i&&i<9&&(a.fontSize=9,t.scaleX*=i/9,t.scaleY*=i/9);var o=(a.fontSize||a.fontFamily)&&[a.fontStyle,a.fontWeight,(a.fontSize||12)+"px",a.fontFamily||"sans-serif"].join(" ");a.font=o;var s=t.getBoundingRect();return this._textX+=s.width,e.add(t),t},n.internalField=function(){Re={g:function(r,e){var t=new D;return G(e,t),L(r,t,this._defsUsePending,!1,!1),t},rect:function(r,e){var t=new re;return G(e,t),L(r,t,this._defsUsePending,!1,!1),t.setShape({x:parseFloat(r.getAttribute("x")||"0"),y:parseFloat(r.getAttribute("y")||"0"),width:parseFloat(r.getAttribute("width")||"0"),height:parseFloat(r.getAttribute("height")||"0")}),t.silent=!0,t},circle:function(r,e){var t=new Bt;return G(e,t),L(r,t,this._defsUsePending,!1,!1),t.setShape({cx:parseFloat(r.getAttribute("cx")||"0"),cy:parseFloat(r.getAttribute("cy")||"0"),r:parseFloat(r.getAttribute("r")||"0")}),t.silent=!0,t},line:function(r,e){var t=new Gr;return G(e,t),L(r,t,this._defsUsePending,!1,!1),t.setShape({x1:parseFloat(r.getAttribute("x1")||"0"),y1:parseFloat(r.getAttribute("y1")||"0"),x2:parseFloat(r.getAttribute("x2")||"0"),y2:parseFloat(r.getAttribute("y2")||"0")}),t.silent=!0,t},ellipse:function(r,e){var t=new Lr;return G(e,t),L(r,t,this._defsUsePending,!1,!1),t.setShape({cx:parseFloat(r.getAttribute("cx")||"0"),cy:parseFloat(r.getAttribute("cy")||"0"),rx:parseFloat(r.getAttribute("rx")||"0"),ry:parseFloat(r.getAttribute("ry")||"0")}),t.silent=!0,t},polygon:function(r,e){var t=r.getAttribute("points"),a;t&&(a=nt(t));var i=new Ne({shape:{points:a||[]},silent:!0});return G(e,i),L(r,i,this._defsUsePending,!1,!1),i},polyline:function(r,e){var t=r.getAttribute("points"),a;t&&(a=nt(t));var i=new Xt({shape:{points:a||[]},silent:!0});return G(e,i),L(r,i,this._defsUsePending,!1,!1),i},image:function(r,e){var t=new Ut;return G(e,t),L(r,t,this._defsUsePending,!1,!1),t.setStyle({image:r.getAttribute("xlink:href")||r.getAttribute("href"),x:+r.getAttribute("x"),y:+r.getAttribute("y"),width:+r.getAttribute("width"),height:+r.getAttribute("height")}),t.silent=!0,t},text:function(r,e){var t=r.getAttribute("x")||"0",a=r.getAttribute("y")||"0",i=r.getAttribute("dx")||"0",o=r.getAttribute("dy")||"0";this._textX=parseFloat(t)+parseFloat(i),this._textY=parseFloat(a)+parseFloat(o);var s=new D;return G(e,s),L(r,s,this._defsUsePending,!1,!0),s},tspan:function(r,e){var t=r.getAttribute("x"),a=r.getAttribute("y");t!=null&&(this._textX=parseFloat(t)),a!=null&&(this._textY=parseFloat(a));var i=r.getAttribute("dx")||"0",o=r.getAttribute("dy")||"0",s=new D;return G(e,s),L(r,s,this._defsUsePending,!1,!0),this._textX+=parseFloat(i),this._textY+=parseFloat(o),s},path:function(r,e){var t=r.getAttribute("d")||"",a=Cr(t);return G(e,a),L(r,a,this._defsUsePending,!1,!1),a.silent=!0,a}}}(),n}(),rt={lineargradient:function(n){var r=parseInt(n.getAttribute("x1")||"0",10),e=parseInt(n.getAttribute("y1")||"0",10),t=parseInt(n.getAttribute("x2")||"10",10),a=parseInt(n.getAttribute("y2")||"0",10),i=new Zt(r,e,t,a);return at(n,i),it(n,i),i},radialgradient:function(n){var r=parseInt(n.getAttribute("cx")||"0",10),e=parseInt(n.getAttribute("cy")||"0",10),t=parseInt(n.getAttribute("r")||"0",10),a=new Ar(r,e,t);return at(n,a),it(n,a),a}};function at(n,r){var e=n.getAttribute("gradientUnits");e==="userSpaceOnUse"&&(r.global=!0)}function it(n,r){for(var e=n.firstChild;e;){if(e.nodeType===1&&e.nodeName.toLocaleLowerCase()==="stop"){var t=e.getAttribute("offset"),a=void 0;t&&t.indexOf("%")>0?a=parseInt(t,10)/100:t?a=parseFloat(t):a=0;var i={};hr(e,i,i);var o=i.stopColor||e.getAttribute("stop-color")||"#000000";r.colorStops.push({offset:a,color:o})}e=e.nextSibling}}function G(n,r){n&&n.__inheritedStyle&&(r.__inheritedStyle||(r.__inheritedStyle={}),Yt(r.__inheritedStyle,n.__inheritedStyle))}function nt(n){for(var r=Se(n),e=[],t=0;t<r.length;t+=2){var a=parseFloat(r[t]),i=parseFloat(r[t+1]);e.push([a,i])}return e}function L(n,r,e,t,a){var i=r,o=i.__inheritedStyle=i.__inheritedStyle||{},s={};n.nodeType===1&&(Ga(n,r),hr(n,o,s),t||Aa(n,o,s)),i.style=i.style||{},o.fill!=null&&(i.style.fill=ot(i,"fill",o.fill,e)),o.stroke!=null&&(i.style.stroke=ot(i,"stroke",o.stroke,e)),d(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],function(l){o[l]!=null&&(i.style[l]=parseFloat(o[l]))}),d(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign"],function(l){o[l]!=null&&(i.style[l]=o[l])}),a&&(i.__selfStyle=s),o.lineDash&&(i.style.lineDash=E(Se(o.lineDash),function(l){return parseFloat(l)})),(o.visibility==="hidden"||o.visibility==="collapse")&&(i.invisible=!0),o.display==="none"&&(i.ignore=!0)}function Ia(n,r){var e=r.__selfStyle;if(e){var t=e.textBaseline,a=t;!t||t==="auto"||t==="baseline"?a="alphabetic":t==="before-edge"||t==="text-before-edge"?a="top":t==="after-edge"||t==="text-after-edge"?a="bottom":(t==="central"||t==="mathematical")&&(a="middle"),n.style.textBaseline=a}var i=r.__inheritedStyle;if(i){var o=i.textAlign,s=o;o&&(o==="middle"&&(s="center"),n.style.textAlign=s)}}var Ra=/^url\(\s*#(.*?)\)/;function ot(n,r,e,t){var a=e&&e.match(Ra);if(a){var i=Pr(a[1]);t.push([n,r,i]);return}return e==="none"&&(e=null),e}function Da(n,r){for(var e=0;e<r.length;e++){var t=r[e];t[0].style[t[1]]=n[t[2]]}}var Ca=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function Se(n){return n.match(Ca)||[]}var La=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.eE,]*)\)/g,De=Math.PI/180;function Ga(n,r){var e=n.getAttribute("transform");if(e){e=e.replace(/,/g," ");var t=[],a=null;e.replace(La,function(c,h,f){return t.push(h,f),""});for(var i=t.length-1;i>0;i-=2){var o=t[i],s=t[i-1],l=Se(o);switch(a=a||Jt(),s){case"translate":zr(a,a,[parseFloat(l[0]),parseFloat(l[1]||"0")]);break;case"scale":Or(a,a,[parseFloat(l[0]),parseFloat(l[1]||l[0])]);break;case"rotate":Fr(a,a,-parseFloat(l[0])*De);break;case"skewX":var u=Math.tan(parseFloat(l[0])*De);Pe(a,[1,0,u,1,0,0],a);break;case"skewY":var p=Math.tan(parseFloat(l[0])*De);Pe(a,[1,p,0,1,0,0],a);break;case"matrix":a[0]=parseFloat(l[0]),a[1]=parseFloat(l[1]),a[2]=parseFloat(l[2]),a[3]=parseFloat(l[3]),a[4]=parseFloat(l[4]),a[5]=parseFloat(l[5]);break}}r.setLocalTransform(a)}}var st=/([^\s:;]+)\s*:\s*([^:;]+)/g;function hr(n,r,e){var t=n.getAttribute("style");if(t){st.lastIndex=0;for(var a;(a=st.exec(t))!=null;){var i=a[1],o=ae(de,i)?de[i]:null;o&&(r[o]=a[2]);var s=ae(ye,i)?ye[i]:null;s&&(e[s]=a[2])}}}function Aa(n,r,e){for(var t=0;t<et.length;t++){var a=et[t],i=n.getAttribute(a);i!=null&&(r[de[a]]=i)}for(var t=0;t<tt.length;t++){var a=tt[t],i=n.getAttribute(a);i!=null&&(e[ye[a]]=i)}}function vr(n,r){var e=r.width/n.width,t=r.height/n.height,a=Math.min(e,t);return{scale:a,x:-(n.x+n.width/2)*a+(r.x+r.width/2),y:-(n.y+n.height/2)*a+(r.y+r.height/2)}}function Pa(n,r){var e=new Va;return e.parse(n,r)}var Fa=1e-8;function lt(n,r){return Math.abs(n-r)<Fa}function ut(n,r,e){var t=0,a=n[0];if(!a)return!1;for(var i=1;i<n.length;i++){var o=n[i];t+=Ze(a[0],a[1],o[0],o[1],r,e),a=o}var s=n[0];return(!lt(a[0],s[0])||!lt(a[1],s[1]))&&(t+=Ze(a[0],a[1],s[0],s[1],r,e)),t!==0}var Oa=[];function Ce(n,r){for(var e=0;e<n.length;e++)ie(n[e],n[e],r)}function ct(n,r,e,t){for(var a=0;a<n.length;a++){var i=n[a];t&&(i=t.project(i)),i&&isFinite(i[0])&&isFinite(i[1])&&($t(r,r,i),jt(e,e,i))}}function za(n){for(var r=0,e=0,t=0,a=n.length,i=n[a-1][0],o=n[a-1][1],s=0;s<a;s++){var l=n[s][0],u=n[s][1],p=i*u-l*o;r+=p,e+=(i+l)*p,t+=(o+u)*p,i=l,o=u}return r?[e/r/3,t/r/3,r]:[n[0][0]||0,n[0][1]||0]}var gr=function(){function n(r){this.name=r}return n.prototype.setCenter=function(r){this._center=r},n.prototype.getCenter=function(){var r=this._center;return r||(r=this._center=this.calcCenter()),r},n}(),pt=function(){function n(r,e){this.type="polygon",this.exterior=r,this.interiors=e}return n}(),ft=function(){function n(r){this.type="linestring",this.points=r}return n}(),dr=function(n){V(r,n);function r(e,t,a){var i=n.call(this,e)||this;return i.type="geoJSON",i.geometries=t,i._center=a&&[a[0],a[1]],i}return r.prototype.calcCenter=function(){for(var e=this.geometries,t,a=0,i=0;i<e.length;i++){var o=e[i],s=o.exterior,l=s&&s.length;l>a&&(t=o,a=l)}if(t)return za(t.exterior);var u=this.getBoundingRect();return[u.x+u.width/2,u.y+u.height/2]},r.prototype.getBoundingRect=function(e){var t=this._rect;if(t&&!e)return t;var a=[1/0,1/0],i=[-1/0,-1/0],o=this.geometries;return d(o,function(s){s.type==="polygon"?ct(s.exterior,a,i,e):d(s.points,function(l){ct(l,a,i,e)})}),isFinite(a[0])&&isFinite(a[1])&&isFinite(i[0])&&isFinite(i[1])||(a[0]=a[1]=i[0]=i[1]=0),t=new k(a[0],a[1],i[0]-a[0],i[1]-a[1]),e||(this._rect=t),t},r.prototype.contain=function(e){var t=this.getBoundingRect(),a=this.geometries;if(!t.contain(e[0],e[1]))return!1;e:for(var i=0,o=a.length;i<o;i++){var s=a[i];if(s.type==="polygon"){var l=s.exterior,u=s.interiors;if(ut(l,e[0],e[1])){for(var p=0;p<(u?u.length:0);p++)if(ut(u[p],e[0],e[1]))continue e;return!0}}}return!1},r.prototype.transformTo=function(e,t,a,i){var o=this.getBoundingRect(),s=o.width/o.height;a?i||(i=a/s):a=s*i;for(var l=new k(e,t,a,i),u=o.calculateTransform(l),p=this.geometries,c=0;c<p.length;c++){var h=p[c];h.type==="polygon"?(Ce(h.exterior,u),d(h.interiors,function(f){Ce(f,u)})):d(h.points,function(f){Ce(f,u)})}o=this._rect,o.copy(l),this._center=[o.x+o.width/2,o.y+o.height/2]},r.prototype.cloneShallow=function(e){e==null&&(e=this.name);var t=new r(e,this.geometries,this._center);return t._rect=this._rect,t.transformTo=null,t},r}(gr),Ea=function(n){V(r,n);function r(e,t){var a=n.call(this,e)||this;return a.type="geoSVG",a._elOnlyForCalculate=t,a}return r.prototype.calcCenter=function(){for(var e=this._elOnlyForCalculate,t=e.getBoundingRect(),a=[t.x+t.width/2,t.y+t.height/2],i=Er(Oa),o=e;o&&!o.isGeoSVGGraphicRoot;)Pe(i,o.getLocalTransform(),i),o=o.parent;return Wt(i,i),ie(a,a,i),a},r}(gr),Ha=x(["rect","circle","line","ellipse","polygon","polyline","path","text","tspan","g"]),ka=function(){function n(r,e){this.type="geoSVG",this._usedGraphicMap=x(),this._freedGraphics=[],this._mapName=r,this._parsedXML=fr(e)}return n.prototype.load=function(){var r=this._firstGraphic;if(!r){r=this._firstGraphic=this._buildGraphic(this._parsedXML),this._freedGraphics.push(r),this._boundingRect=this._firstGraphic.boundingRect.clone();var e=Ya(r.named),t=e.regions,a=e.regionsMap;this._regions=t,this._regionsMap=a}return{boundingRect:this._boundingRect,regions:this._regions,regionsMap:this._regionsMap}},n.prototype._buildGraphic=function(r){var e,t;try{e=r&&Pa(r,{ignoreViewBox:!0,ignoreRootClip:!0})||{},t=e.root,Kt(t!=null)}catch(y){throw new Error(`Invalid svg format
`+y.message)}var a=new D;a.add(t),a.isGeoSVGGraphicRoot=!0;var i=e.width,o=e.height,s=e.viewBoxRect,l=this._boundingRect;if(!l){var u=void 0,p=void 0,c=void 0,h=void 0;if(i!=null?(u=0,c=i):s&&(u=s.x,c=s.width),o!=null?(p=0,h=o):s&&(p=s.y,h=s.height),u==null||p==null){var f=t.getBoundingRect();u==null&&(u=f.x,c=f.width),p==null&&(p=f.y,h=f.height)}l=this._boundingRect=new k(u,p,c,h)}if(s){var v=vr(s,l);t.scaleX=t.scaleY=v.scale,t.x=v.x,t.y=v.y}a.setClipPath(new re({shape:l.plain()}));var g=[];return d(e.named,function(y){Ha.get(y.svgNodeTagLower)!=null&&(g.push(y),Na(y.el))}),{root:a,boundingRect:l,named:g}},n.prototype.useGraphic=function(r){var e=this._usedGraphicMap,t=e.get(r);return t||(t=this._freedGraphics.pop()||this._buildGraphic(this._parsedXML),e.set(r,t),t)},n.prototype.freeGraphic=function(r){var e=this._usedGraphicMap,t=e.get(r);t&&(e.removeKey(r),this._freedGraphics.push(t))},n}();function Na(n){n.silent=!1,n.isGroup&&n.traverse(function(r){r.silent=!1})}function Ya(n){var r=[],e=x();return d(n,function(t){if(t.namedFrom==null){var a=new Ea(t.name,t.el);r.push(a),e.set(t.name,a)}}),{regions:r,regionsMap:e}}function Ua(n){if(!n.UTF8Encoding)return n;var r=n,e=r.UTF8Scale;e==null&&(e=1024);var t=r.features;return d(t,function(a){var i=a.geometry,o=i.encodeOffsets,s=i.coordinates;if(o)switch(i.type){case"LineString":i.coordinates=yr(s,o,e);break;case"Polygon":Le(s,o,e);break;case"MultiLineString":Le(s,o,e);break;case"MultiPolygon":d(s,function(l,u){return Le(l,o[u],e)})}}),r.UTF8Encoding=!1,r}function Le(n,r,e){for(var t=0;t<n.length;t++)n[t]=yr(n[t],r[t],e)}function yr(n,r,e){for(var t=[],a=r[0],i=r[1],o=0;o<n.length;o+=2){var s=n.charCodeAt(o)-64,l=n.charCodeAt(o+1)-64;s=s>>1^-(s&1),l=l>>1^-(l&1),s+=a,l+=i,a=s,i=l,t.push([s/e,l/e])}return t}function Xa(n,r){return n=Ua(n),E(Hr(n.features,function(e){return e.geometry&&e.properties&&e.geometry.coordinates.length>0}),function(e){var t=e.properties,a=e.geometry,i=[];switch(a.type){case"Polygon":var o=a.coordinates;i.push(new pt(o[0],o.slice(1)));break;case"MultiPolygon":d(a.coordinates,function(l){l[0]&&i.push(new pt(l[0],l.slice(1)))});break;case"LineString":i.push(new ft([a.coordinates]));break;case"MultiLineString":i.push(new ft(a.coordinates))}var s=new dr(t[r||"name"],i,t.cp);return s.properties=t,s})}var Oe=[126,25],ht="南海诸岛",Y=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]];for(var N=0;N<Y.length;N++)for(var J=0;J<Y[N].length;J++)Y[N][J][0]/=10.5,Y[N][J][1]/=-10.5/.75,Y[N][J][0]+=Oe[0],Y[N][J][1]+=Oe[1];function Ba(n,r){if(n==="china"){for(var e=0;e<r.length;e++)if(r[e].name===ht)return;r.push(new dr(ht,E(Y,function(t){return{type:"polygon",exterior:t}}),Oe))}}var Za={南海诸岛:[32,80],广东:[0,-10],香港:[10,5],澳门:[-10,10],天津:[5,5]};function Ja(n,r){if(n==="china"){var e=Za[r.name];if(e){var t=r.getCenter();t[0]+=e[0]/10.5,t[1]+=-e[1]/(10.5/.75),r.setCenter(t)}}}var Wa=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]];function $a(n,r){n==="china"&&r.name==="台湾"&&r.geometries.push({type:"polygon",exterior:Wa[0]})}var ja="name",Ka=function(){function n(r,e,t){this.type="geoJSON",this._parsedMap=x(),this._mapName=r,this._specialAreas=t,this._geoJSON=Qa(e)}return n.prototype.load=function(r,e){e=e||ja;var t=this._parsedMap.get(e);if(!t){var a=this._parseToRegions(e);t=this._parsedMap.set(e,{regions:a,boundingRect:qa(a)})}var i=x(),o=[];return d(t.regions,function(s){var l=s.name;r&&ae(r,l)&&(s=s.cloneShallow(l=r[l])),o.push(s),i.set(l,s)}),{regions:o,boundingRect:t.boundingRect||new k(0,0,0,0),regionsMap:i}},n.prototype._parseToRegions=function(r){var e=this._mapName,t=this._geoJSON,a;try{a=t?Xa(t,r):[]}catch(i){throw new Error(`Invalid geoJson format
`+i.message)}return Ba(e,a),d(a,function(i){var o=i.name;Ja(e,i),$a(e,i);var s=this._specialAreas&&this._specialAreas[o];s&&i.transformTo(s.left,s.top,s.width,s.height)},this),a},n.prototype.getMapForUser=function(){return{geoJson:this._geoJSON,geoJSON:this._geoJSON,specialAreas:this._specialAreas}},n}();function qa(n){for(var r,e=0;e<n.length;e++){var t=n[e].getBoundingRect();r=r||t.clone(),r.union(t)}return r}function Qa(n){return Z(n)?typeof JSON<"u"&&JSON.parse?JSON.parse(n):new Function("return ("+n+");")():n}var j=x();const H={registerMap:function(n,r,e){if(r.svg){var t=new ka(n,r.svg);j.set(n,t)}else{var a=r.geoJson||r.geoJSON;a&&!r.features?e=r.specialAreas:a=r;var t=new Ka(n,a,e);j.set(n,t)}},getGeoResource:function(n){return j.get(n)},getMapForUser:function(n){var r=j.get(n);return r&&r.type==="geoJSON"&&r.getMapForUser()},load:function(n,r,e){var t=j.get(n);if(t)return t.load(r,e)}};var Ye=["rect","circle","line","ellipse","polygon","polyline","path"],ei=x(Ye),ti=x(Ye.concat(["g"])),ri=x(Ye.concat(["g"])),mr=Nr();function le(n){var r=n.getItemStyle(),e=n.get("areaColor");return e!=null&&(r.fill=e),r}function vt(n){var r=n.style;r&&(r.stroke=r.stroke||r.fill,r.fill=null)}var _r=function(){function n(r){var e=new D;this.uid=kr("ec_map_draw"),this._controller=new wa(r.getZr()),this._controllerHost={target:e},this.group=e,e.add(this._regionsGroup=new D),e.add(this._svgGroup=new D)}return n.prototype.draw=function(r,e,t,a,i){var o=r.mainType==="geo",s=r.getData&&r.getData();o&&e.eachComponent({mainType:"series",subType:"map"},function(m){!s&&m.getHostGeoModel()===r&&(s=m.getData())});var l=r.coordinateSystem,u=this._regionsGroup,p=this.group,c=l.getTransformInfo(),h=c.raw,f=c.roam,v=!u.childAt(0)||i;v?(p.x=f.x,p.y=f.y,p.scaleX=f.scaleX,p.scaleY=f.scaleY,p.dirty()):Yr(p,f,r);var g=s&&s.getVisual("visualMeta")&&s.getVisual("visualMeta").length>0,y={api:t,geo:l,mapOrGeoModel:r,data:s,isVisualEncodedByVisualMap:g,isGeo:o,transformInfoRaw:h};l.resourceType==="geoJSON"?this._buildGeoJSON(y):l.resourceType==="geoSVG"&&this._buildSVG(y),this._updateController(r,e,t),this._updateMapSelectHandler(r,u,t,a)},n.prototype._buildGeoJSON=function(r){var e=this._regionsGroupByName=x(),t=x(),a=this._regionsGroup,i=r.transformInfoRaw,o=r.mapOrGeoModel,s=r.data,l=r.geo.projection,u=l&&l.stream;function p(f,v){return v&&(f=v(f)),f&&[f[0]*i.scaleX+i.x,f[1]*i.scaleY+i.y]}function c(f){for(var v=[],g=!u&&l&&l.project,y=0;y<f.length;++y){var m=p(f[y],g);m&&v.push(m)}return v}function h(f){return{shape:{points:c(f)}}}a.removeAll(),d(r.geo.regions,function(f){var v=f.name,g=e.get(v),y=t.get(v)||{},m=y.dataIdx,S=y.regionModel;g||(g=e.set(v,new D),a.add(g),m=s?s.indexOfName(v):null,S=r.isGeo?o.getRegionModel(v):s?s.getItemModel(m):null,t.set(v,{dataIdx:m,regionModel:S}));var _=[],M=[];d(f.geometries,function(C){if(C.type==="polygon"){var P=[C.exterior].concat(C.interiors||[]);u&&(P=St(P,u)),d(P,function(z){_.push(new Ne(h(z)))})}else{var R=C.points;u&&(R=St(R,u,!0)),d(R,function(z){M.push(new Xt(h(z)))})}});var I=p(f.getCenter(),l&&l.project);function b(C,P){if(C.length){var R=new Ur({culling:!0,segmentIgnoreThreshold:1,shape:{paths:C}});g.add(R),gt(r,R,m,S),dt(r,R,v,S,o,m,I),P&&(vt(R),d(R.states,vt))}}b(_),b(M,!0)}),e.each(function(f,v){var g=t.get(v),y=g.dataIdx,m=g.regionModel;yt(r,f,v,m,o,y),mt(r,f,v,m,o),_t(r,f,v,m,o)},this)},n.prototype._buildSVG=function(r){var e=r.geo.map,t=r.transformInfoRaw;this._svgGroup.x=t.x,this._svgGroup.y=t.y,this._svgGroup.scaleX=t.scaleX,this._svgGroup.scaleY=t.scaleY,this._svgResourceChanged(e)&&(this._freeSVG(),this._useSVG(e));var a=this._svgDispatcherMap=x(),i=!1;d(this._svgGraphicRecord.named,function(o){var s=o.name,l=r.mapOrGeoModel,u=r.data,p=o.svgNodeTagLower,c=o.el,h=u?u.indexOfName(s):null,f=l.getRegionModel(s);if(ei.get(p)!=null&&c instanceof Je&&gt(r,c,h,f),c instanceof Je&&(c.culling=!0),c.z2EmphasisLift=0,!o.namedFrom&&(ri.get(p)!=null&&dt(r,c,s,f,l,h,null),yt(r,c,s,f,l,h),mt(r,c,s,f,l),ti.get(p)!=null)){var v=_t(r,c,s,f,l);v==="self"&&(i=!0);var g=a.get(s)||a.set(s,[]);g.push(c)}},this),this._enableBlurEntireSVG(i,r)},n.prototype._enableBlurEntireSVG=function(r,e){if(r&&e.isGeo){var t=e.mapOrGeoModel.getModel(["blur","itemStyle"]).getItemStyle(),a=t.opacity;this._svgGraphicRecord.root.traverse(function(i){if(!i.isGroup){qt(i);var o=i.ensureState("blur").style||{};o.opacity==null&&a!=null&&(o.opacity=a),i.ensureState("emphasis")}})}},n.prototype.remove=function(){this._regionsGroup.removeAll(),this._regionsGroupByName=null,this._svgGroup.removeAll(),this._freeSVG(),this._controller.dispose(),this._controllerHost=null},n.prototype.findHighDownDispatchers=function(r,e){if(r==null)return[];var t=e.coordinateSystem;if(t.resourceType==="geoJSON"){var a=this._regionsGroupByName;if(a){var i=a.get(r);return i?[i]:[]}}else if(t.resourceType==="geoSVG")return this._svgDispatcherMap&&this._svgDispatcherMap.get(r)||[]},n.prototype._svgResourceChanged=function(r){return this._svgMapName!==r},n.prototype._useSVG=function(r){var e=H.getGeoResource(r);if(e&&e.type==="geoSVG"){var t=e.useGraphic(this.uid);this._svgGroup.add(t.root),this._svgGraphicRecord=t,this._svgMapName=r}},n.prototype._freeSVG=function(){var r=this._svgMapName;if(r!=null){var e=H.getGeoResource(r);e&&e.type==="geoSVG"&&e.freeGraphic(this.uid),this._svgGraphicRecord=null,this._svgDispatcherMap=null,this._svgGroup.removeAll(),this._svgMapName=null}},n.prototype._updateController=function(r,e,t){var a=r.coordinateSystem,i=this._controller,o=this._controllerHost;o.zoomLimit=r.get("scaleLimit"),o.zoom=a.getZoom(),i.enable(r.get("roam")||!1);var s=r.mainType;function l(){var u={type:"geoRoam",componentType:s};return u[s+"Id"]=r.id,u}i.off("pan").on("pan",function(u){this._mouseDownFlag=!1,Ta(o,u.dx,u.dy),t.dispatchAction(ne(l(),{dx:u.dx,dy:u.dy,animation:{duration:0}}))},this),i.off("zoom").on("zoom",function(u){this._mouseDownFlag=!1,xa(o,u.scale,u.originX,u.originY),t.dispatchAction(ne(l(),{zoom:u.scale,originX:u.originX,originY:u.originY,animation:{duration:0}}))},this),i.setPointerChecker(function(u,p,c){return a.containPoint([p,c])&&!Sa(u,t,r)})},n.prototype.resetForLabelLayout=function(){this.group.traverse(function(r){var e=r.getTextContent();e&&(e.ignore=mr(e).ignore)})},n.prototype._updateMapSelectHandler=function(r,e,t,a){var i=this;e.off("mousedown"),e.off("click"),r.get("selectedMode")&&(e.on("mousedown",function(){i._mouseDownFlag=!0}),e.on("click",function(o){i._mouseDownFlag&&(i._mouseDownFlag=!1)}))},n}();function gt(n,r,e,t){var a=t.getModel("itemStyle"),i=t.getModel(["emphasis","itemStyle"]),o=t.getModel(["blur","itemStyle"]),s=t.getModel(["select","itemStyle"]),l=le(a),u=le(i),p=le(s),c=le(o),h=n.data;if(h){var f=h.getItemVisual(e,"style"),v=h.getItemVisual(e,"decal");n.isVisualEncodedByVisualMap&&f.fill&&(l.fill=f.fill),v&&(l.decal=Xr(v,n.api))}r.setStyle(l),r.style.strokeNoScale=!0,r.ensureState("emphasis").style=u,r.ensureState("select").style=p,r.ensureState("blur").style=c,qt(r)}function dt(n,r,e,t,a,i,o){var s=n.data,l=n.isGeo,u=s&&isNaN(s.get(s.mapDimension("value"),i)),p=s&&s.getItemLayout(i);if(l||u||p&&p.showLabel){var c=l?e:i,h=void 0;(!s||i>=0)&&(h=a);var f=o?{normal:{align:"center",verticalAlign:"middle"}}:null;Qt(r,er(t),{labelFetcher:h,labelDataIndex:c,defaultText:e},f);var v=r.getTextContent();if(v&&(mr(v).ignore=v.ignore,r.textConfig&&o)){var g=r.getBoundingRect().clone();r.textConfig.layoutRect=g,r.textConfig.position=[(o[0]-g.x)/g.width*100+"%",(o[1]-g.y)/g.height*100+"%"]}r.disableLabelAnimation=!0}else r.removeTextContent(),r.removeTextConfig(),r.disableLabelAnimation=null}function yt(n,r,e,t,a,i){n.data?n.data.setItemGraphicEl(i,r):ve(r).eventData={componentType:"geo",componentIndex:a.componentIndex,geoIndex:a.componentIndex,name:e,region:t&&t.option||{}}}function mt(n,r,e,t,a){n.data||Br({el:r,componentModel:a,itemName:e,itemTooltipOption:t.get("tooltip")})}function _t(n,r,e,t,a){r.highDownSilentOnTouch=!!a.get("selectedMode");var i=t.getModel("emphasis"),o=i.get("focus");return Zr(r,o,i.get("blurScope"),i.get("disabled")),n.isGeo&&Jr(r,a,e),o}function St(n,r,e){var t=[],a;function i(){a=[]}function o(){a.length&&(t.push(a),a=[])}var s=r({polygonStart:i,polygonEnd:o,lineStart:i,lineEnd:o,point:function(l,u){isFinite(l)&&isFinite(u)&&a.push([l,u])},sphere:function(){}});return!e&&s.polygonStart(),d(n,function(l){s.lineStart();for(var u=0;u<l.length;u++)s.point(l[u][0],l[u][1]);s.lineEnd()}),!e&&s.polygonEnd(),t}var ai=function(n){V(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e}return r.prototype.render=function(e,t,a,i){if(!(i&&i.type==="mapToggleSelect"&&i.from===this.uid)){var o=this.group;if(o.removeAll(),!e.getHostGeoModel()){if(this._mapDraw&&i&&i.type==="geoRoam"&&this._mapDraw.resetForLabelLayout(),i&&i.type==="geoRoam"&&i.componentType==="series"&&i.seriesId===e.id){var s=this._mapDraw;s&&o.add(s.group)}else if(e.needsDrawMap){var s=this._mapDraw||new _r(a);o.add(s.group),s.draw(e,t,a,this,i),this._mapDraw=s}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;e.get("showLegendSymbol")&&t.getComponent("legend")&&this._renderSymbols(e,t,a)}}},r.prototype.remove=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},r.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},r.prototype._renderSymbols=function(e,t,a){var i=e.originalData,o=this.group;i.each(i.mapDimension("value"),function(s,l){if(!isNaN(s)){var u=i.getItemLayout(l);if(!(!u||!u.point)){var p=u.point,c=u.offset,h=new Bt({style:{fill:e.getData().getVisual("style").fill},shape:{cx:p[0]+c*9,cy:p[1],r:3},silent:!0,z2:8+(c?0:Wr+1)});if(!c){var f=e.mainSeries.getData(),v=i.getName(l),g=f.indexOfName(v),y=i.getItemModel(l),m=y.getModel("label"),S=f.getItemGraphicEl(g);Qt(h,er(y),{labelFetcher:{getFormattedLabel:function(_,M){return e.getFormattedLabel(g,M)}},defaultText:v}),h.disableLabelAnimation=!0,m.get("position")||h.setTextConfig({position:"bottom"}),S.onHoverStateChange=function(_){$r(h,_)}}o.add(h)}}})},r.type="map",r}(jr),ii=function(n){V(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e.needsDrawMap=!1,e.seriesGroup=[],e.getTooltipPosition=function(t){if(t!=null){var a=this.getData().getName(t),i=this.coordinateSystem,o=i.getRegion(a);return o&&i.dataToPoint(o.getCenter())}},e}return r.prototype.getInitialData=function(e){for(var t=ba(this,{coordDimensions:["value"],encodeDefaulter:Kr(qr,this)}),a=x(),i=[],o=0,s=t.count();o<s;o++){var l=t.getName(o);a.set(l,!0)}var u=H.load(this.getMapType(),this.option.nameMap,this.option.nameProperty);return d(u.regions,function(p){var c=p.name;a.get(c)||i.push(c)}),t.appendValues([],i),t},r.prototype.getHostGeoModel=function(){var e=this.option.geoIndex;return e!=null?this.ecModel.getComponent("geo",e):null},r.prototype.getMapType=function(){return(this.getHostGeoModel()||this).option.map},r.prototype.getRawValue=function(e){var t=this.getData();return t.get(t.mapDimension("value"),e)},r.prototype.getRegionModel=function(e){var t=this.getData();return t.getItemModel(t.indexOfName(e))},r.prototype.formatTooltip=function(e,t,a){for(var i=this.getData(),o=this.getRawValue(e),s=i.getName(e),l=this.seriesGroup,u=[],p=0;p<l.length;p++){var c=l[p].originalData.indexOfName(s),h=i.mapDimension("value");isNaN(l[p].originalData.get(h,c))||u.push(l[p].name)}return We("section",{header:u.join(", "),noHeader:!u.length,blocks:[We("nameValue",{name:s,value:o})]})},r.prototype.setZoom=function(e){this.option.zoom=e},r.prototype.setCenter=function(e){this.option.center=e},r.prototype.getLegendIcon=function(e){var t=e.icon||"roundRect",a=ge(t,0,0,e.itemWidth,e.itemHeight,e.itemStyle.fill);return a.setStyle(e.itemStyle),a.style.stroke="none",t.indexOf("empty")>-1&&(a.style.stroke=a.style.fill,a.style.fill="#fff",a.style.lineWidth=2),a},r.type="series.map",r.dependencies=["geo"],r.layoutMode="box",r.defaultOption={z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:null,showLegendSymbol:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,selectedMode:!0,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},nameProperty:"name"},r}(Qr);function ni(n,r){var e={};return d(n,function(t){t.each(t.mapDimension("value"),function(a,i){var o="ec-"+t.getName(i);e[o]=e[o]||[],isNaN(a)||e[o].push(a)})}),n[0].map(n[0].mapDimension("value"),function(t,a){for(var i="ec-"+n[0].getName(a),o=0,s=1/0,l=-1/0,u=e[i].length,p=0;p<u;p++)s=Math.min(s,e[i][p]),l=Math.max(l,e[i][p]),o+=e[i][p];var c;return r==="min"?c=s:r==="max"?c=l:r==="average"?c=o/u:c=o,u===0?NaN:c})}function oi(n){var r={};n.eachSeriesByType("map",function(e){var t=e.getHostGeoModel(),a=t?"o"+t.id:"i"+e.getMapType();(r[a]=r[a]||[]).push(e)}),d(r,function(e,t){for(var a=ni(E(e,function(o){return o.getData()}),e[0].get("mapValueCalculation")),i=0;i<e.length;i++)e[i].originalData=e[i].getData();for(var i=0;i<e.length;i++)e[i].seriesGroup=e,e[i].needsDrawMap=i===0&&!e[i].getHostGeoModel(),e[i].setData(a.cloneShallow()),e[i].mainSeries=e[0]})}function si(n){var r={};n.eachSeriesByType("map",function(e){var t=e.getMapType();if(!(e.getHostGeoModel()||r[t])){var a={};d(e.seriesGroup,function(o){var s=o.coordinateSystem,l=o.originalData;o.get("showLegendSymbol")&&n.getComponent("legend")&&l.each(l.mapDimension("value"),function(u,p){var c=l.getName(p),h=s.getRegion(c);if(!(!h||isNaN(u))){var f=a[c]||0,v=s.dataToPoint(h.getCenter());a[c]=f+1,l.setItemLayout(p,{point:v,offset:f})}})});var i=e.getData();i.each(function(o){var s=i.getName(o),l=i.getItemLayout(o)||{};l.showLabel=!a[s],i.setItemLayout(o,l)}),r[t]=!0}})}var Mt=ie,Sr=function(n){V(r,n);function r(e){var t=n.call(this)||this;return t.type="view",t.dimensions=["x","y"],t._roamTransformable=new se,t._rawTransformable=new se,t.name=e,t}return r.prototype.setBoundingRect=function(e,t,a,i){return this._rect=new k(e,t,a,i),this._rect},r.prototype.getBoundingRect=function(){return this._rect},r.prototype.setViewRect=function(e,t,a,i){this._transformTo(e,t,a,i),this._viewRect=new k(e,t,a,i)},r.prototype._transformTo=function(e,t,a,i){var o=this.getBoundingRect(),s=this._rawTransformable;s.transform=o.calculateTransform(new k(e,t,a,i));var l=s.parent;s.parent=null,s.decomposeTransform(),s.parent=l,this._updateTransform()},r.prototype.setCenter=function(e,t){e&&(this._center=[Q(e[0],t.getWidth()),Q(e[1],t.getHeight())],this._updateCenterAndZoom())},r.prototype.setZoom=function(e){e=e||1;var t=this.zoomLimit;t&&(t.max!=null&&(e=Math.min(t.max,e)),t.min!=null&&(e=Math.max(t.min,e))),this._zoom=e,this._updateCenterAndZoom()},r.prototype.getDefaultCenter=function(){var e=this.getBoundingRect(),t=e.x+e.width/2,a=e.y+e.height/2;return[t,a]},r.prototype.getCenter=function(){return this._center||this.getDefaultCenter()},r.prototype.getZoom=function(){return this._zoom||1},r.prototype.getRoamTransform=function(){return this._roamTransformable.getLocalTransform()},r.prototype._updateCenterAndZoom=function(){var e=this._rawTransformable.getLocalTransform(),t=this._roamTransformable,a=this.getDefaultCenter(),i=this.getCenter(),o=this.getZoom();i=ie([],i,e),a=ie([],a,e),t.originX=i[0],t.originY=i[1],t.x=a[0]-i[0],t.y=a[1]-i[1],t.scaleX=t.scaleY=o,this._updateTransform()},r.prototype._updateTransform=function(){var e=this._roamTransformable,t=this._rawTransformable;t.parent=e,e.updateTransform(),t.updateTransform(),ea(this.transform||(this.transform=[]),t.transform||Jt()),this._rawTransform=t.getLocalTransform(),this.invTransform=this.invTransform||[],Wt(this.invTransform,this.transform),this.decomposeTransform()},r.prototype.getTransformInfo=function(){var e=this._rawTransformable,t=this._roamTransformable,a=new se;return a.transform=t.transform,a.decomposeTransform(),{roam:{x:a.x,y:a.y,scaleX:a.scaleX,scaleY:a.scaleY},raw:{x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY}}},r.prototype.getViewRect=function(){return this._viewRect},r.prototype.getViewRectAfterRoam=function(){var e=this.getBoundingRect().clone();return e.applyTransform(this.transform),e},r.prototype.dataToPoint=function(e,t,a){var i=t?this._rawTransform:this.transform;return a=a||[],i?Mt(a,e,i):ta(a,e)},r.prototype.pointToData=function(e){var t=this.invTransform;return t?Mt([],e,t):[e[0],e[1]]},r.prototype.convertToPixel=function(e,t,a){var i=bt(t);return i===this?i.dataToPoint(a):null},r.prototype.convertFromPixel=function(e,t,a){var i=bt(t);return i===this?i.pointToData(a):null},r.prototype.containPoint=function(e){return this.getViewRectAfterRoam().contain(e[0],e[1])},r.dimensions=["x","y"],r}(se);function bt(n){var r=n.seriesModel;return r?r.coordinateSystem:null}var li={geoJSON:{aspectScale:.75,invertLongitute:!0},geoSVG:{aspectScale:1,invertLongitute:!1}},Mr=["lng","lat"],ze=function(n){V(r,n);function r(e,t,a){var i=n.call(this,e)||this;i.dimensions=Mr,i.type="geo",i._nameCoordMap=x(),i.map=t;var o=a.projection,s=H.load(t,a.nameMap,a.nameProperty),l=H.getGeoResource(t);i.resourceType=l?l.type:null;var u=i.regions=s.regions,p=li[l.type];i._regionsMap=s.regionsMap,i.regions=s.regions,i.projection=o;var c;if(o)for(var h=0;h<u.length;h++){var f=u[h].getBoundingRect(o);c=c||f.clone(),c.union(f)}else c=s.boundingRect;return i.setBoundingRect(c.x,c.y,c.width,c.height),i.aspectScale=o?1:ra(a.aspectScale,p.aspectScale),i._invertLongitute=o?!1:p.invertLongitute,i}return r.prototype._transformTo=function(e,t,a,i){var o=this.getBoundingRect(),s=this._invertLongitute;o=o.clone(),s&&(o.y=-o.y-o.height);var l=this._rawTransformable;l.transform=o.calculateTransform(new k(e,t,a,i));var u=l.parent;l.parent=null,l.decomposeTransform(),l.parent=u,s&&(l.scaleY=-l.scaleY),this._updateTransform()},r.prototype.getRegion=function(e){return this._regionsMap.get(e)},r.prototype.getRegionByCoord=function(e){for(var t=this.regions,a=0;a<t.length;a++){var i=t[a];if(i.type==="geoJSON"&&i.contain(e))return t[a]}},r.prototype.addGeoCoord=function(e,t){this._nameCoordMap.set(e,t)},r.prototype.getGeoCoord=function(e){var t=this._regionsMap.get(e);return this._nameCoordMap.get(e)||t&&t.getCenter()},r.prototype.dataToPoint=function(e,t,a){if(Z(e)&&(e=this.getGeoCoord(e)),e){var i=this.projection;return i&&(e=i.project(e)),e&&this.projectedToPoint(e,t,a)}},r.prototype.pointToData=function(e){var t=this.projection;return t&&(e=t.unproject(e)),e&&this.pointToProjected(e)},r.prototype.pointToProjected=function(e){return n.prototype.pointToData.call(this,e)},r.prototype.projectedToPoint=function(e,t,a){return n.prototype.dataToPoint.call(this,e,t,a)},r.prototype.convertToPixel=function(e,t,a){var i=wt(t);return i===this?i.dataToPoint(a):null},r.prototype.convertFromPixel=function(e,t,a){var i=wt(t);return i===this?i.pointToData(a):null},r}(Sr);aa(ze,Sr);function wt(n){var r=n.geoModel,e=n.seriesModel;return r?r.coordinateSystem:e?e.coordinateSystem||(e.getReferringComponents("geo",ia).models[0]||{}).coordinateSystem:null}function Tt(n,r){var e=n.get("boundingCoords");if(e!=null){var t=e[0],a=e[1];if(isFinite(t[0])&&isFinite(t[1])&&isFinite(a[0])&&isFinite(a[1])){var i=this.projection;if(i){var o=t[0],s=t[1],l=a[0],u=a[1];t=[1/0,1/0],a=[-1/0,-1/0];var p=function(b,C,P,R){for(var z=P-b,$=R-C,Me=0;Me<=100;Me++){var Ue=Me/100,Xe=i.project([b+z*Ue,C+$*Ue]);$t(t,t,Xe),jt(a,a,Xe)}};p(o,s,l,s),p(l,s,l,u),p(l,u,o,u),p(o,u,l,s)}this.setBoundingRect(t[0],t[1],a[0]-t[0],a[1]-t[1])}}var c=this.getBoundingRect(),h=n.get("layoutCenter"),f=n.get("layoutSize"),v=r.getWidth(),g=r.getHeight(),y=c.width/c.height*this.aspectScale,m=!1,S,_;h&&f&&(S=[Q(h[0],v),Q(h[1],g)],_=Q(f,Math.min(v,g)),!isNaN(S[0])&&!isNaN(S[1])&&!isNaN(_)&&(m=!0));var M;if(m)M={},y>1?(M.width=_,M.height=_/y):(M.height=_,M.width=_*y),M.y=S[1]-M.height/2,M.x=S[0]-M.width/2;else{var I=n.getBoxLayoutParams();I.aspect=y,M=rr(I,{width:v,height:g})}this.setViewRect(M.x,M.y,M.width,M.height),this.setCenter(n.get("center"),r),this.setZoom(n.get("zoom"))}function ui(n,r){d(r.get("geoCoord"),function(e,t){n.addGeoCoord(t,e)})}var ci=function(){function n(){this.dimensions=Mr}return n.prototype.create=function(r,e){var t=[];function a(o){return{nameProperty:o.get("nameProperty"),aspectScale:o.get("aspectScale"),projection:o.get("projection")}}r.eachComponent("geo",function(o,s){var l=o.get("map"),u=new ze(l+s,l,ne({nameMap:o.get("nameMap")},a(o)));u.zoomLimit=o.get("scaleLimit"),t.push(u),o.coordinateSystem=u,u.model=o,u.resize=Tt,u.resize(o,e)}),r.eachSeries(function(o){var s=o.get("coordinateSystem");if(s==="geo"){var l=o.get("geoIndex")||0;o.coordinateSystem=t[l]}});var i={};return r.eachSeriesByType("map",function(o){if(!o.getHostGeoModel()){var s=o.getMapType();i[s]=i[s]||[],i[s].push(o)}}),d(i,function(o,s){var l=E(o,function(p){return p.get("nameMap")}),u=new ze(s,s,ne({nameMap:na(l)},a(o[0])));u.zoomLimit=tr.apply(null,E(o,function(p){return p.get("scaleLimit")})),t.push(u),u.resize=Tt,u.resize(o[0],e),d(o,function(p){p.coordinateSystem=u,ui(u,p)})}),t},n.prototype.getFilledRegions=function(r,e,t,a){for(var i=(r||[]).slice(),o=x(),s=0;s<i.length;s++)o.set(i[s].name,i[s]);var l=H.load(e,t,a);return d(l.regions,function(u){var p=u.name;!o.get(p)&&i.push({name:p})}),i},n}(),br=new ci,pi=function(n){V(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e}return r.prototype.init=function(e,t,a){var i=H.getGeoResource(e.map);if(i&&i.type==="geoJSON"){var o=e.itemStyle=e.itemStyle||{};"color"in o||(o.color="#eee")}this.mergeDefaultAndTheme(e,a),oa(e,"label",["show"])},r.prototype.optionUpdated=function(){var e=this,t=this.option;t.regions=br.getFilledRegions(t.regions,t.map,t.nameMap,t.nameProperty);var a={};this._optionModelMap=sa(t.regions||[],function(i,o){var s=o.name;return s&&(i.set(s,new $e(o,e,e.ecModel)),o.selected&&(a[s]=!0)),i},x()),t.selectedMap||(t.selectedMap=a)},r.prototype.getRegionModel=function(e){return this._optionModelMap.get(e)||new $e(null,this,this.ecModel)},r.prototype.getFormattedLabel=function(e,t){var a=this.getRegionModel(e),i=t==="normal"?a.get(["label","formatter"]):a.get(["emphasis","label","formatter"]),o={name:e};if(ar(i))return o.status=t,i(o);if(Z(i))return i.replace("{a}",e??"")},r.prototype.setZoom=function(e){this.option.zoom=e},r.prototype.setCenter=function(e){this.option.center=e},r.prototype.select=function(e){var t=this.option,a=t.selectedMode;if(a){a!=="multiple"&&(t.selectedMap=null);var i=t.selectedMap||(t.selectedMap={});i[e]=!0}},r.prototype.unSelect=function(e){var t=this.option.selectedMap;t&&(t[e]=!1)},r.prototype.toggleSelected=function(e){this[this.isSelected(e)?"unSelect":"select"](e)},r.prototype.isSelected=function(e){var t=this.option.selectedMap;return!!(t&&t[e])},r.type="geo",r.layoutMode="box",r.defaultOption={z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},r}(ir);function xt(n,r){return n.pointToProjected?n.pointToProjected(r):n.pointToData(r)}function fi(n,r,e,t){var a=n.getZoom(),i=n.getCenter(),o=r.zoom,s=n.projectedToPoint?n.projectedToPoint(i):n.dataToPoint(i);if(r.dx!=null&&r.dy!=null&&(s[0]-=r.dx,s[1]-=r.dy,n.setCenter(xt(n,s),t)),o!=null){if(e){var l=e.min||0,u=e.max||1/0;o=Math.max(Math.min(a*o,u),l)/a}n.scaleX*=o,n.scaleY*=o;var p=(r.originX-n.x)*(o-1),c=(r.originY-n.y)*(o-1);n.x-=p,n.y-=c,n.updateTransform(),n.setCenter(xt(n,s),t),n.setZoom(o*a)}return{center:n.getCenter(),zoom:n.getZoom()}}var hi=function(n){V(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e.focusBlurEnabled=!0,e}return r.prototype.init=function(e,t){this._api=t},r.prototype.render=function(e,t,a,i){if(this._model=e,!e.get("show")){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;return}this._mapDraw||(this._mapDraw=new _r(a));var o=this._mapDraw;o.draw(e,t,a,this,i),o.group.on("click",this._handleRegionClick,this),o.group.silent=e.get("silent"),this.group.add(o.group),this.updateSelectStatus(e,t,a)},r.prototype._handleRegionClick=function(e){var t;nr(e.target,function(a){return(t=ve(a).eventData)!=null},!0),t&&this._api.dispatchAction({type:"geoToggleSelect",geoId:this._model.id,name:t.name})},r.prototype.updateSelectStatus=function(e,t,a){var i=this;this._mapDraw.group.traverse(function(o){var s=ve(o).eventData;if(s)return i._model.isSelected(s.name)?a.enterSelect(o):a.leaveSelect(o),!0})},r.prototype.findHighDownDispatchers=function(e){return this._mapDraw&&this._mapDraw.findHighDownDispatchers(e,this._model)},r.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove()},r.type="geo",r}(or);function vi(n,r,e){H.registerMap(n,r,e)}function gi(n){n.registerCoordinateSystem("geo",br),n.registerComponentModel(pi),n.registerComponentView(hi),n.registerImpl("registerMap",vi),n.registerImpl("getMap",function(e){return H.getMapForUser(e)});function r(e,t){t.update="geo:updateSelectStatus",n.registerAction(t,function(a,i){var o={},s=[];return i.eachComponent({mainType:"geo",query:a},function(l){l[e](a.name);var u=l.coordinateSystem;d(u.regions,function(c){o[c.name]=l.isSelected(c.name)||!1});var p=[];d(o,function(c,h){o[h]&&p.push(h)}),s.push({geoIndex:l.componentIndex,name:p})}),{selected:o,allSelected:s,name:a.name}})}r("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),r("select",{type:"geoSelect",event:"geoselected"}),r("unSelect",{type:"geoUnSelect",event:"geounselected"}),n.registerAction({type:"geoRoam",event:"geoRoam",update:"updateTransform"},function(e,t,a){var i=e.componentType||"series";t.eachComponent({mainType:i,query:e},function(o){var s=o.coordinateSystem;if(s.type==="geo"){var l=fi(s,e,o.get("scaleLimit"),a);o.setCenter&&o.setCenter(l.center),o.setZoom&&o.setZoom(l.zoom),i==="series"&&d(o.seriesGroup,function(u){u.setCenter(l.center),u.setZoom(l.zoom)})}})})}function Zi(n){Fe(gi),n.registerChartView(ai),n.registerSeriesModel(ii),n.registerLayout(si),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,oi),la("map",n.registerAction)}var oe=d,di=X,me=-1,w=function(){function n(r){var e=r.mappingMethod,t=r.type,a=this.option=A(r);this.type=t,this.mappingMethod=e,this._normalizeData=_i[e];var i=n.visualHandlers[t];this.applyVisual=i.applyVisual,this.getColorMapper=i.getColorMapper,this._normalizedToVisual=i._normalizedToVisual[e],e==="piecewise"?(Ge(a),yi(a)):e==="category"?a.categories?mi(a):Ge(a,!0):(Kt(e!=="linear"||a.dataExtent),Ge(a))}return n.prototype.mapValueToVisual=function(r){var e=this._normalizeData(r);return this._normalizedToVisual(e,r)},n.prototype.getNormalizer=function(){return T(this._normalizeData,this)},n.listVisualTypes=function(){return ke(n.visualHandlers)},n.isValidType=function(r){return n.visualHandlers.hasOwnProperty(r)},n.eachVisual=function(r,e,t){X(r)?d(r,e,t):e.call(t,r)},n.mapVisual=function(r,e,t){var a,i=O(r)?[]:X(r)?{}:(a=!0,null);return n.eachVisual(r,function(o,s){var l=e.call(t,o,s);a?i=l:i[s]=l}),i},n.retrieveVisuals=function(r){var e={},t;return r&&oe(n.visualHandlers,function(a,i){r.hasOwnProperty(i)&&(e[i]=r[i],t=!0)}),t?e:null},n.prepareVisualTypes=function(r){if(O(r))r=r.slice();else if(di(r)){var e=[];oe(r,function(t,a){e.push(a)}),r=e}else return[];return r.sort(function(t,a){return a==="color"&&t!=="color"&&t.indexOf("color")===0?1:-1}),r},n.dependsOn=function(r,e){return e==="color"?!!(r&&r.indexOf(e)===0):r===e},n.findPieceIndex=function(r,e,t){for(var a,i=1/0,o=0,s=e.length;o<s;o++){var l=e[o].value;if(l!=null){if(l===r||Z(l)&&l===r+"")return o;t&&h(l,o)}}for(var o=0,s=e.length;o<s;o++){var u=e[o],p=u.interval,c=u.close;if(p){if(p[0]===-1/0){if(ce(c[1],r,p[1]))return o}else if(p[1]===1/0){if(ce(c[0],p[0],r))return o}else if(ce(c[0],p[0],r)&&ce(c[1],r,p[1]))return o;t&&h(p[0],o),t&&h(p[1],o)}}if(t)return r===1/0?e.length-1:r===-1/0?0:a;function h(f,v){var g=Math.abs(f-r);g<i&&(i=g,a=v)}},n.visualHandlers={color:{applyVisual:K("color"),getColorMapper:function(){var r=this.option;return T(r.mappingMethod==="category"?function(e,t){return!t&&(e=this._normalizeData(e)),q.call(this,e)}:function(e,t,a){var i=!!a;return!t&&(e=this._normalizeData(e)),a=we(e,r.parsedVisual,a),i?a:be(a,"rgba")},this)},_normalizedToVisual:{linear:function(r){return be(we(r,this.option.parsedVisual),"rgba")},category:q,piecewise:function(r,e){var t=He.call(this,e);return t==null&&(t=be(we(r,this.option.parsedVisual),"rgba")),t},fixed:U}},colorHue:ue(function(r,e){return Te(r,e)}),colorSaturation:ue(function(r,e){return Te(r,null,e)}),colorLightness:ue(function(r,e){return Te(r,null,null,e)}),colorAlpha:ue(function(r,e){return pa(r,e)}),decal:{applyVisual:K("decal"),_normalizedToVisual:{linear:null,category:q,piecewise:null,fixed:null}},opacity:{applyVisual:K("opacity"),_normalizedToVisual:Ee([0,1])},liftZ:{applyVisual:K("liftZ"),_normalizedToVisual:{linear:U,category:U,piecewise:U,fixed:U}},symbol:{applyVisual:function(r,e,t){var a=this.mapValueToVisual(r);t("symbol",a)},_normalizedToVisual:{linear:Vt,category:q,piecewise:function(r,e){var t=He.call(this,e);return t==null&&(t=Vt.call(this,r)),t},fixed:U}},symbolSize:{applyVisual:K("symbolSize"),_normalizedToVisual:Ee([0,1])}},n}();function yi(n){var r=n.pieceList;n.hasSpecialVisual=!1,d(r,function(e,t){e.originIndex=t,e.visual!=null&&(n.hasSpecialVisual=!0)})}function mi(n){var r=n.categories,e=n.categoryMap={},t=n.visual;if(oe(r,function(o,s){e[o]=s}),!O(t)){var a=[];X(t)?oe(t,function(o,s){var l=e[s];a[l??me]=o}):a[me]=t,t=wr(n,a)}for(var i=r.length-1;i>=0;i--)t[i]==null&&(delete e[r[i]],r.pop())}function Ge(n,r){var e=n.visual,t=[];X(e)?oe(e,function(i){t.push(i)}):e!=null&&t.push(e);var a={color:1,symbol:1};!r&&t.length===1&&!a.hasOwnProperty(n.type)&&(t[1]=t[0]),wr(n,t)}function ue(n){return{applyVisual:function(r,e,t){var a=this.mapValueToVisual(r);t("color",n(e("color"),a))},_normalizedToVisual:Ee([0,1])}}function Vt(n){var r=this.option.visual;return r[Math.round(B(n,[0,1],[0,r.length-1],!0))]||{}}function K(n){return function(r,e,t){t(n,this.mapValueToVisual(r))}}function q(n){var r=this.option.visual;return r[this.option.loop&&n!==me?n%r.length:n]}function U(){return this.option.visual[0]}function Ee(n){return{linear:function(r){return B(r,n,this.option.visual,!0)},category:q,piecewise:function(r,e){var t=He.call(this,e);return t==null&&(t=B(r,n,this.option.visual,!0)),t},fixed:U}}function He(n){var r=this.option,e=r.pieceList;if(r.hasSpecialVisual){var t=w.findPieceIndex(n,e),a=e[t];if(a&&a.visual)return a.visual[this.type]}}function wr(n,r){return n.visual=r,n.type==="color"&&(n.parsedVisual=E(r,function(e){var t=ca(e);return t||[0,0,0,1]})),r}var _i={linear:function(n){return B(n,this.option.dataExtent,[0,1],!0)},piecewise:function(n){var r=this.option.pieceList,e=w.findPieceIndex(n,r,!0);if(e!=null)return B(e,[0,r.length-1],[0,1],!0)},category:function(n){var r=this.option.categories?this.option.categoryMap[n]:n;return r??me},fixed:ua};function ce(n,r,e){return n?r<=e:r<e}var It=d;function Rt(n){if(n){for(var r in n)if(n.hasOwnProperty(r))return!0}}function Dt(n,r,e){var t={};return It(r,function(i){var o=t[i]=a();It(n[i],function(s,l){if(w.isValidType(l)){var u={type:l,visual:s};e&&e(u,i),o[l]=new w(u),l==="opacity"&&(u=A(u),u.type="colorAlpha",o.__hidden.__alphaForOpacity=new w(u))}})}),t;function a(){var i=function(){};i.prototype.__hidden=i.prototype;var o=new i;return o}}function Si(n,r,e){var t;d(e,function(a){r.hasOwnProperty(a)&&Rt(r[a])&&(t=!0)}),t&&d(e,function(a){r.hasOwnProperty(a)&&Rt(r[a])?n[a]=A(r[a]):delete n[a]})}function Ji(n,r,e,t,a,i){var o={};d(n,function(c){var h=w.prepareVisualTypes(r[c]);o[c]=h});var s;function l(c){return sr(e,s,c)}function u(c,h){lr(e,s,c,h)}e.each(p);function p(c,h){s=c;var f=e.getRawDataItem(s);if(!(f&&f.visualMap===!1))for(var v=t.call(a,c),g=r[v],y=o[v],m=0,S=y.length;m<S;m++){var _=y[m];g[_]&&g[_].applyVisual(c,l,u)}}}function Mi(n,r,e,t){var a={};return d(n,function(i){var o=w.prepareVisualTypes(r[i]);a[i]=o}),{progress:function(o,s){var l;t!=null&&(l=s.getDimensionIndex(t));function u(I){return sr(s,c,I)}function p(I,b){lr(s,c,I,b)}for(var c,h=s.getStore();(c=o.next())!=null;){var f=s.getRawDataItem(c);if(!(f&&f.visualMap===!1))for(var v=t!=null?h.get(l,c):c,g=e(v),y=r[g],m=a[g],S=0,_=m.length;S<_;S++){var M=m[S];y[M]&&y[M].applyVisual(v,u,p)}}}}}var Tr={get:function(n,r,e){var t=A((bi[n]||{})[r]);return e&&O(t)?t[t.length-1]:t}},bi={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},Ct=w.mapVisual,wi=w.eachVisual,Ti=O,Lt=d,xi=ur,Vi=B,_e=function(n){V(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e.stateList=["inRange","outOfRange"],e.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],e.layoutMode={type:"box",ignoreSize:!0},e.dataBound=[-1/0,1/0],e.targetVisuals={},e.controllerVisuals={},e}return r.prototype.init=function(e,t,a){this.mergeDefaultAndTheme(e,a)},r.prototype.optionUpdated=function(e,t){var a=this.option;!t&&Si(a,e,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},r.prototype.resetVisual=function(e){var t=this.stateList;e=T(e,this),this.controllerVisuals=Dt(this.option.controller,t,e),this.targetVisuals=Dt(this.option.target,t,e)},r.prototype.getItemSymbol=function(){return null},r.prototype.getTargetSeriesIndices=function(){var e=this.option.seriesIndex,t=[];return e==null||e==="all"?this.ecModel.eachSeries(function(a,i){t.push(i)}):t=fa(e),t},r.prototype.eachTargetSeries=function(e,t){d(this.getTargetSeriesIndices(),function(a){var i=this.ecModel.getSeriesByIndex(a);i&&e.call(t,i)},this)},r.prototype.isTargetSeries=function(e){var t=!1;return this.eachTargetSeries(function(a){a===e&&(t=!0)}),t},r.prototype.formatValueText=function(e,t,a){var i=this.option,o=i.precision,s=this.dataBound,l=i.formatter,u;a=a||["<",">"],O(e)&&(e=e.slice(),u=!0);var p=t?e:u?[c(e[0]),c(e[1])]:c(e);if(Z(l))return l.replace("{value}",u?p[0]:p).replace("{value2}",u?p[1]:p);if(ar(l))return u?l(e[0],e[1]):l(e);if(u)return e[0]===s[0]?a[0]+" "+p[1]:e[1]===s[1]?a[1]+" "+p[0]:p[0]+" - "+p[1];return p;function c(h){return h===s[0]?"min":h===s[1]?"max":(+h).toFixed(Math.min(o,20))}},r.prototype.resetExtent=function(){var e=this.option,t=xi([e.min,e.max]);this._dataExtent=t},r.prototype.getDataDimensionIndex=function(e){var t=this.option.dimension;if(t!=null)return e.getDimensionIndex(t);for(var a=e.dimensions,i=a.length-1;i>=0;i--){var o=a[i],s=e.getDimensionInfo(o);if(!s.isCalculationCoord)return s.storeDimIndex}},r.prototype.getExtent=function(){return this._dataExtent.slice()},r.prototype.completeVisualOption=function(){var e=this.ecModel,t=this.option,a={inRange:t.inRange,outOfRange:t.outOfRange},i=t.target||(t.target={}),o=t.controller||(t.controller={});je(i,a),je(o,a);var s=this.isCategory();l.call(this,i),l.call(this,o),u.call(this,i,"inRange","outOfRange"),p.call(this,o);function l(c){Ti(t.color)&&!c.inRange&&(c.inRange={color:t.color.slice().reverse()}),c.inRange=c.inRange||{color:e.get("gradientColor")}}function u(c,h,f){var v=c[h],g=c[f];v&&!g&&(g=c[f]={},Lt(v,function(y,m){if(w.isValidType(m)){var S=Tr.get(m,"inactive",s);S!=null&&(g[m]=S,m==="color"&&!g.hasOwnProperty("opacity")&&!g.hasOwnProperty("colorAlpha")&&(g.opacity=[0,0]))}}))}function p(c){var h=(c.inRange||{}).symbol||(c.outOfRange||{}).symbol,f=(c.inRange||{}).symbolSize||(c.outOfRange||{}).symbolSize,v=this.get("inactiveColor"),g=this.getItemSymbol(),y=g||"roundRect";Lt(this.stateList,function(m){var S=this.itemSize,_=c[m];_||(_=c[m]={color:s?v:[v]}),_.symbol==null&&(_.symbol=h&&A(h)||(s?y:[y])),_.symbolSize==null&&(_.symbolSize=f&&A(f)||(s?S[0]:[S[0],S[0]])),_.symbol=Ct(_.symbol,function(b){return b==="none"?y:b});var M=_.symbolSize;if(M!=null){var I=-1/0;wi(M,function(b){b>I&&(I=b)}),_.symbolSize=Ct(M,function(b){return Vi(b,[0,I],[0,S[0]],!0)})}},this)}},r.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},r.prototype.isCategory=function(){return!!this.option.categories},r.prototype.setSelected=function(e){},r.prototype.getSelected=function(){return null},r.prototype.getValueState=function(e){return null},r.prototype.getVisualMeta=function(e){return null},r.type="visualMap",r.dependencies=["series"],r.defaultOption={show:!0,z:4,seriesIndex:"all",min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,textStyle:{color:"#333"}},r}(ir),Gt=[20,140],Ii=function(n){V(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e}return r.prototype.optionUpdated=function(e,t){n.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual(function(a){a.mappingMethod="linear",a.dataExtent=this.getExtent()}),this._resetRange()},r.prototype.resetItemSize=function(){n.prototype.resetItemSize.apply(this,arguments);var e=this.itemSize;(e[0]==null||isNaN(e[0]))&&(e[0]=Gt[0]),(e[1]==null||isNaN(e[1]))&&(e[1]=Gt[1])},r.prototype._resetRange=function(){var e=this.getExtent(),t=this.option.range;!t||t.auto?(e.auto=1,this.option.range=e):O(t)&&(t[0]>t[1]&&t.reverse(),t[0]=Math.max(t[0],e[0]),t[1]=Math.min(t[1],e[1]))},r.prototype.completeVisualOption=function(){n.prototype.completeVisualOption.apply(this,arguments),d(this.stateList,function(e){var t=this.option.controller[e].symbolSize;t&&t[0]!==t[1]&&(t[0]=t[1]/3)},this)},r.prototype.setSelected=function(e){this.option.range=e.slice(),this._resetRange()},r.prototype.getSelected=function(){var e=this.getExtent(),t=ur((this.get("range")||[]).slice());return t[0]>e[1]&&(t[0]=e[1]),t[1]>e[1]&&(t[1]=e[1]),t[0]<e[0]&&(t[0]=e[0]),t[1]<e[0]&&(t[1]=e[0]),t},r.prototype.getValueState=function(e){var t=this.option.range,a=this.getExtent();return(t[0]<=a[0]||t[0]<=e)&&(t[1]>=a[1]||e<=t[1])?"inRange":"outOfRange"},r.prototype.findTargetDataIndices=function(e){var t=[];return this.eachTargetSeries(function(a){var i=[],o=a.getData();o.each(this.getDataDimensionIndex(o),function(s,l){e[0]<=s&&s<=e[1]&&i.push(l)},this),t.push({seriesId:a.id,dataIndex:i})},this),t},r.prototype.getVisualMeta=function(e){var t=At(this,"outOfRange",this.getExtent()),a=At(this,"inRange",this.option.range.slice()),i=[];function o(f,v){i.push({value:f,color:e(f,v)})}for(var s=0,l=0,u=a.length,p=t.length;l<p&&(!a.length||t[l]<=a[0]);l++)t[l]<a[s]&&o(t[l],"outOfRange");for(var c=1;s<u;s++,c=0)c&&i.length&&o(a[s],"outOfRange"),o(a[s],"inRange");for(var c=1;l<p;l++)(!a.length||a[a.length-1]<t[l])&&(c&&(i.length&&o(i[i.length-1].value,"outOfRange"),c=0),o(t[l],"outOfRange"));var h=i.length;return{stops:i,outerColors:[h?i[0].color:"transparent",h?i[h-1].color:"transparent"]}},r.type="visualMap.continuous",r.defaultOption=cr(_e.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:"#fff",borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}}),r}(_e);function At(n,r,e){if(e[0]===e[1])return e.slice();for(var t=200,a=(e[1]-e[0])/t,i=e[0],o=[],s=0;s<=t&&i<e[1];s++)o.push(i),i+=a;return o.push(e[1]),o}var xr=function(n){V(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e.autoPositionValues={left:1,right:1,top:1,bottom:1},e}return r.prototype.init=function(e,t){this.ecModel=e,this.api=t},r.prototype.render=function(e,t,a,i){if(this.visualMapModel=e,e.get("show")===!1){this.group.removeAll();return}this.doRender(e,t,a,i)},r.prototype.renderBackground=function(e){var t=this.visualMapModel,a=ha(t.get("padding")||0),i=e.getBoundingRect();e.add(new re({z2:-1,silent:!0,shape:{x:i.x-a[3],y:i.y-a[0],width:i.width+a[3]+a[1],height:i.height+a[0]+a[2]},style:{fill:t.get("backgroundColor"),stroke:t.get("borderColor"),lineWidth:t.get("borderWidth")}}))},r.prototype.getControllerVisual=function(e,t,a){a=a||{};var i=a.forceState,o=this.visualMapModel,s={};if(t==="color"){var l=o.get("contentColor");s.color=l}function u(f){return s[f]}function p(f,v){s[f]=v}var c=o.controllerVisuals[i||o.getValueState(e)],h=w.prepareVisualTypes(c);return d(h,function(f){var v=c[f];a.convertOpacityToAlpha&&f==="opacity"&&(f="colorAlpha",v=c.__alphaForOpacity),w.dependsOn(f,t)&&v&&v.applyVisual(e,u,p)}),s[t]},r.prototype.positionGroup=function(e){var t=this.visualMapModel,a=this.api;va(e,t.getBoxLayoutParams(),{width:a.getWidth(),height:a.getHeight()})},r.prototype.doRender=function(e,t,a,i){},r.type="visualMap",r}(or),Pt=[["left","right","width"],["top","bottom","height"]];function Vr(n,r,e){var t=n.option,a=t.align;if(a!=null&&a!=="auto")return a;for(var i={width:r.getWidth(),height:r.getHeight()},o=t.orient==="horizontal"?1:0,s=Pt[o],l=[0,null,10],u={},p=0;p<3;p++)u[Pt[1-o][p]]=l[p],u[s[p]]=p===2?e[0]:t[s[p]];var c=[["x","width",3],["y","height",0]][o],h=rr(u,i,t.padding);return s[(h.margin[c[2]]||0)+h[c[0]]+h[c[1]]*.5<i[c[1]]*.5?0:1]}function he(n,r){return d(n||[],function(e){e.dataIndex!=null&&(e.dataIndexInside=e.dataIndex,e.dataIndex=null),e.highlightKey="visualMap"+(r?r.componentIndex:"")}),n}var F=B,Ri=d,Ft=Math.min,Ae=Math.max,Di=12,Ci=6,Li=function(n){V(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e._shapes={},e._dataInterval=[],e._handleEnds=[],e._hoverLinkDataIndices=[],e}return r.prototype.doRender=function(e,t,a,i){this._api=a,(!i||i.type!=="selectDataRange"||i.from!==this.uid)&&this._buildView()},r.prototype._buildView=function(){this.group.removeAll();var e=this.visualMapModel,t=this.group;this._orient=e.get("orient"),this._useHandle=e.get("calculable"),this._resetInterval(),this._renderBar(t);var a=e.get("text");this._renderEndsText(t,a,0),this._renderEndsText(t,a,1),this._updateView(!0),this.renderBackground(t),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(t)},r.prototype._renderEndsText=function(e,t,a){if(t){var i=t[1-a];i=i!=null?i+"":"";var o=this.visualMapModel,s=o.get("textGap"),l=o.itemSize,u=this._shapes.mainGroup,p=this._applyTransform([l[0]/2,a===0?-s:l[1]+s],u),c=this._applyTransform(a===0?"bottom":"top",u),h=this._orient,f=this.visualMapModel.textStyleModel;this.group.add(new ee({style:pe(f,{x:p[0],y:p[1],verticalAlign:h==="horizontal"?"middle":c,align:h==="horizontal"?c:"center",text:i})}))}},r.prototype._renderBar=function(e){var t=this.visualMapModel,a=this._shapes,i=t.itemSize,o=this._orient,s=this._useHandle,l=Vr(t,this.api,i),u=a.mainGroup=this._createBarGroup(l),p=new D;u.add(p),p.add(a.outOfRange=Ot()),p.add(a.inRange=Ot(null,s?Et(this._orient):null,T(this._dragHandle,this,"all",!1),T(this._dragHandle,this,"all",!0))),p.setClipPath(new re({shape:{x:0,y:0,width:i[0],height:i[1],r:3}}));var c=t.textStyleModel.getTextRect("国"),h=Ae(c.width,c.height);s&&(a.handleThumbs=[],a.handleLabels=[],a.handleLabelPoints=[],this._createHandle(t,u,0,i,h,o),this._createHandle(t,u,1,i,h,o)),this._createIndicator(t,u,i,h,o),e.add(u)},r.prototype._createHandle=function(e,t,a,i,o,s){var l=T(this._dragHandle,this,a,!1),u=T(this._dragHandle,this,a,!0),p=Ke(e.get("handleSize"),i[0]),c=ge(e.get("handleIcon"),-p/2,-p/2,p,p,null,!0),h=Et(this._orient);c.attr({cursor:h,draggable:!0,drift:l,ondragend:u,onmousemove:function(m){te(m.event)}}),c.x=i[0]/2,c.useStyle(e.getModel("handleStyle").getItemStyle()),c.setStyle({strokeNoScale:!0,strokeFirst:!0}),c.style.lineWidth*=2,c.ensureState("emphasis").style=e.getModel(["emphasis","handleStyle"]).getItemStyle(),ga(c,!0),t.add(c);var f=this.visualMapModel.textStyleModel,v=new ee({cursor:h,draggable:!0,drift:l,onmousemove:function(m){te(m.event)},ondragend:u,style:pe(f,{x:0,y:0,text:""})});v.ensureState("blur").style={opacity:.1},v.stateTransition={duration:200},this.group.add(v);var g=[p,0],y=this._shapes;y.handleThumbs[a]=c,y.handleLabelPoints[a]=g,y.handleLabels[a]=v},r.prototype._createIndicator=function(e,t,a,i,o){var s=Ke(e.get("indicatorSize"),a[0]),l=ge(e.get("indicatorIcon"),-s/2,-s/2,s,s,null,!0);l.attr({cursor:"move",invisible:!0,silent:!0,x:a[0]/2});var u=e.getModel("indicatorStyle").getItemStyle();if(l instanceof Ut){var p=l.style;l.useStyle(ne({image:p.image,x:p.x,y:p.y,width:p.width,height:p.height},u))}else l.useStyle(u);t.add(l);var c=this.visualMapModel.textStyleModel,h=new ee({silent:!0,invisible:!0,style:pe(c,{x:0,y:0,text:""})});this.group.add(h);var f=[(o==="horizontal"?i/2:Ci)+a[0]/2,0],v=this._shapes;v.indicator=l,v.indicatorLabel=h,v.indicatorLabelPoint=f,this._firstShowIndicator=!0},r.prototype._dragHandle=function(e,t,a,i){if(this._useHandle){if(this._dragging=!t,!t){var o=this._applyTransform([a,i],this._shapes.mainGroup,!0);this._updateInterval(e,o[1]),this._hideIndicator(),this._updateView()}t===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),t?!this._hovering&&this._clearHoverLinkToSeries():zt(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[e],!1)}},r.prototype._resetInterval=function(){var e=this.visualMapModel,t=this._dataInterval=e.getSelected(),a=e.getExtent(),i=[0,e.itemSize[1]];this._handleEnds=[F(t[0],a,i,!0),F(t[1],a,i,!0)]},r.prototype._updateInterval=function(e,t){t=t||0;var a=this.visualMapModel,i=this._handleEnds,o=[0,a.itemSize[1]];Ma(t,i,o,e,0);var s=a.getExtent();this._dataInterval=[F(i[0],o,s,!0),F(i[1],o,s,!0)]},r.prototype._updateView=function(e){var t=this.visualMapModel,a=t.getExtent(),i=this._shapes,o=[0,t.itemSize[1]],s=e?o:this._handleEnds,l=this._createBarVisual(this._dataInterval,a,s,"inRange"),u=this._createBarVisual(a,a,o,"outOfRange");i.inRange.setStyle({fill:l.barColor}).setShape("points",l.barPoints),i.outOfRange.setStyle({fill:u.barColor}).setShape("points",u.barPoints),this._updateHandle(s,l)},r.prototype._createBarVisual=function(e,t,a,i){var o={forceState:i,convertOpacityToAlpha:!0},s=this._makeColorGradient(e,o),l=[this.getControllerVisual(e[0],"symbolSize",o),this.getControllerVisual(e[1],"symbolSize",o)],u=this._createBarPoints(a,l);return{barColor:new Zt(0,0,0,1,s),barPoints:u,handlesColor:[s[0].color,s[s.length-1].color]}},r.prototype._makeColorGradient=function(e,t){var a=100,i=[],o=(e[1]-e[0])/a;i.push({color:this.getControllerVisual(e[0],"color",t),offset:0});for(var s=1;s<a;s++){var l=e[0]+o*s;if(l>e[1])break;i.push({color:this.getControllerVisual(l,"color",t),offset:s/a})}return i.push({color:this.getControllerVisual(e[1],"color",t),offset:1}),i},r.prototype._createBarPoints=function(e,t){var a=this.visualMapModel.itemSize;return[[a[0]-t[0],e[0]],[a[0],e[0]],[a[0],e[1]],[a[0]-t[1],e[1]]]},r.prototype._createBarGroup=function(e){var t=this._orient,a=this.visualMapModel.get("inverse");return new D(t==="horizontal"&&!a?{scaleX:e==="bottom"?1:-1,rotation:Math.PI/2}:t==="horizontal"&&a?{scaleX:e==="bottom"?-1:1,rotation:-Math.PI/2}:t==="vertical"&&!a?{scaleX:e==="left"?1:-1,scaleY:-1}:{scaleX:e==="left"?1:-1})},r.prototype._updateHandle=function(e,t){if(this._useHandle){var a=this._shapes,i=this.visualMapModel,o=a.handleThumbs,s=a.handleLabels,l=i.itemSize,u=i.getExtent();Ri([0,1],function(p){var c=o[p];c.setStyle("fill",t.handlesColor[p]),c.y=e[p];var h=F(e[p],[0,l[1]],u,!0),f=this.getControllerVisual(h,"symbolSize");c.scaleX=c.scaleY=f/l[0],c.x=l[0]-f/2;var v=xe(a.handleLabelPoints[p],Ve(c,this.group));s[p].setStyle({x:v[0],y:v[1],text:i.formatValueText(this._dataInterval[p]),verticalAlign:"middle",align:this._orient==="vertical"?this._applyTransform("left",a.mainGroup):"center"})},this)}},r.prototype._showIndicator=function(e,t,a,i){var o=this.visualMapModel,s=o.getExtent(),l=o.itemSize,u=[0,l[1]],p=this._shapes,c=p.indicator;if(c){c.attr("invisible",!1);var h={convertOpacityToAlpha:!0},f=this.getControllerVisual(e,"color",h),v=this.getControllerVisual(e,"symbolSize"),g=F(e,s,u,!0),y=l[0]-v/2,m={x:c.x,y:c.y};c.y=g,c.x=y;var S=xe(p.indicatorLabelPoint,Ve(c,this.group)),_=p.indicatorLabel;_.attr("invisible",!1);var M=this._applyTransform("left",p.mainGroup),I=this._orient,b=I==="horizontal";_.setStyle({text:(a||"")+o.formatValueText(t),verticalAlign:b?M:"middle",align:b?"center":M});var C={x:y,y:g,style:{fill:f}},P={style:{x:S[0],y:S[1]}};if(o.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var R={duration:100,easing:"cubicInOut",additive:!0};c.x=m.x,c.y=m.y,c.animateTo(C,R),_.animateTo(P,R)}else c.attr(C),_.attr(P);this._firstShowIndicator=!1;var z=this._shapes.handleLabels;if(z)for(var $=0;$<z.length;$++)this._api.enterBlur(z[$])}},r.prototype._enableHoverLinkToSeries=function(){var e=this;this._shapes.mainGroup.on("mousemove",function(t){if(e._hovering=!0,!e._dragging){var a=e.visualMapModel.itemSize,i=e._applyTransform([t.offsetX,t.offsetY],e._shapes.mainGroup,!0,!0);i[1]=Ft(Ae(0,i[1]),a[1]),e._doHoverLinkToSeries(i[1],0<=i[0]&&i[0]<=a[0])}}).on("mouseout",function(){e._hovering=!1,!e._dragging&&e._clearHoverLinkToSeries()})},r.prototype._enableHoverLinkFromSeries=function(){var e=this.api.getZr();this.visualMapModel.option.hoverLink?(e.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),e.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},r.prototype._doHoverLinkToSeries=function(e,t){var a=this.visualMapModel,i=a.itemSize;if(a.option.hoverLink){var o=[0,i[1]],s=a.getExtent();e=Ft(Ae(o[0],e),o[1]);var l=Gi(a,s,o),u=[e-l,e+l],p=F(e,o,s,!0),c=[F(u[0],o,s,!0),F(u[1],o,s,!0)];u[0]<o[0]&&(c[0]=-1/0),u[1]>o[1]&&(c[1]=1/0),t&&(c[0]===-1/0?this._showIndicator(p,c[1],"< ",l):c[1]===1/0?this._showIndicator(p,c[0],"> ",l):this._showIndicator(p,p,"≈ ",l));var h=this._hoverLinkDataIndices,f=[];(t||zt(a))&&(f=this._hoverLinkDataIndices=a.findTargetDataIndices(c));var v=da(h,f);this._dispatchHighDown("downplay",he(v[0],a)),this._dispatchHighDown("highlight",he(v[1],a))}},r.prototype._hoverLinkFromSeriesMouseOver=function(e){var t;if(nr(e.target,function(l){var u=ve(l);if(u.dataIndex!=null)return t=u,!0},!0),!!t){var a=this.ecModel.getSeriesByIndex(t.seriesIndex),i=this.visualMapModel;if(i.isTargetSeries(a)){var o=a.getData(t.dataType),s=o.getStore().get(i.getDataDimensionIndex(o),t.dataIndex);isNaN(s)||this._showIndicator(s,s)}}},r.prototype._hideIndicator=function(){var e=this._shapes;e.indicator&&e.indicator.attr("invisible",!0),e.indicatorLabel&&e.indicatorLabel.attr("invisible",!0);var t=this._shapes.handleLabels;if(t)for(var a=0;a<t.length;a++)this._api.leaveBlur(t[a])},r.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var e=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",he(e,this.visualMapModel)),e.length=0},r.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var e=this.api.getZr();e.off("mouseover",this._hoverLinkFromSeriesMouseOver),e.off("mouseout",this._hideIndicator)},r.prototype._applyTransform=function(e,t,a,i){var o=Ve(t,i?null:this.group);return O(e)?xe(e,o,a):ya(e,o,a)},r.prototype._dispatchHighDown=function(e,t){t&&t.length&&this.api.dispatchAction({type:e,batch:t})},r.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},r.prototype.remove=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},r.type="visualMap.continuous",r}(xr);function Ot(n,r,e,t){return new Ne({shape:{points:n},draggable:!!e,cursor:r,drift:e,onmousemove:function(a){te(a.event)},ondragend:t})}function Gi(n,r,e){var t=Di/2,a=n.get("hoverLinkDataSize");return a&&(t=F(a,r,e,!0)/2),t}function zt(n){var r=n.get("hoverLinkOnHandle");return!!(r??n.get("realtime"))}function Et(n){return n==="vertical"?"ns-resize":"ew-resize"}var Ai={type:"selectDataRange",event:"dataRangeSelected",update:"update"},Pi=function(n,r){r.eachComponent({mainType:"visualMap",query:n},function(e){e.setSelected(n.selected)})},Fi=[{createOnAllSeries:!0,reset:function(n,r){var e=[];return r.eachComponent("visualMap",function(t){var a=n.pipelineContext;!t.isTargetSeries(n)||a&&a.large||e.push(Mi(t.stateList,t.targetVisuals,T(t.getValueState,t),t.getDataDimensionIndex(n.getData())))}),e}},{createOnAllSeries:!0,reset:function(n,r){var e=n.getData(),t=[];r.eachComponent("visualMap",function(a){if(a.isTargetSeries(n)){var i=a.getVisualMeta(T(Oi,null,n,a))||{stops:[],outerColors:[]},o=a.getDataDimensionIndex(e);o>=0&&(i.dimension=o,t.push(i))}}),n.getData().setVisual("visualMeta",t)}}];function Oi(n,r,e,t){for(var a=r.targetVisuals[t],i=w.prepareVisualTypes(a),o={color:ma(n.getData(),"color")},s=0,l=i.length;s<l;s++){var u=i[s],p=a[u==="opacity"?"__alphaForOpacity":u];p&&p.applyVisual(e,c,h)}return o.color;function c(f){return o[f]}function h(f,v){o[f]=v}}var Ht=d;function zi(n){var r=n&&n.visualMap;O(r)||(r=r?[r]:[]),Ht(r,function(e){if(e){W(e,"splitList")&&!W(e,"pieces")&&(e.pieces=e.splitList,delete e.splitList);var t=e.pieces;t&&O(t)&&Ht(t,function(a){X(a)&&(W(a,"start")&&!W(a,"min")&&(a.min=a.start),W(a,"end")&&!W(a,"max")&&(a.max=a.end))})}})}function W(n,r){return n&&n.hasOwnProperty&&n.hasOwnProperty(r)}var kt=!1;function Ir(n){kt||(kt=!0,n.registerSubTypeDefaulter("visualMap",function(r){return!r.categories&&(!(r.pieces?r.pieces.length>0:r.splitNumber>0)||r.calculable)?"continuous":"piecewise"}),n.registerAction(Ai,Pi),d(Fi,function(r){n.registerVisual(n.PRIORITY.VISUAL.COMPONENT,r)}),n.registerPreprocessor(zi))}function Ei(n){n.registerComponentModel(Ii),n.registerComponentView(Li),Ir(n)}var Hi=function(n){V(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e._pieceList=[],e}return r.prototype.optionUpdated=function(e,t){n.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var a=this._mode=this._determineMode();this._pieceList=[],ki[this._mode].call(this,this._pieceList),this._resetSelected(e,t);var i=this.option.categories;this.resetVisual(function(o,s){a==="categories"?(o.mappingMethod="category",o.categories=A(i)):(o.dataExtent=this.getExtent(),o.mappingMethod="piecewise",o.pieceList=E(this._pieceList,function(l){return l=A(l),s!=="inRange"&&(l.visual=null),l}))})},r.prototype.completeVisualOption=function(){var e=this.option,t={},a=w.listVisualTypes(),i=this.isCategory();d(e.pieces,function(s){d(a,function(l){s.hasOwnProperty(l)&&(t[l]=1)})}),d(t,function(s,l){var u=!1;d(this.stateList,function(p){u=u||o(e,p,l)||o(e.target,p,l)},this),!u&&d(this.stateList,function(p){(e[p]||(e[p]={}))[l]=Tr.get(l,p==="inRange"?"active":"inactive",i)})},this);function o(s,l,u){return s&&s[l]&&s[l].hasOwnProperty(u)}n.prototype.completeVisualOption.apply(this,arguments)},r.prototype._resetSelected=function(e,t){var a=this.option,i=this._pieceList,o=(t?a:e).selected||{};if(a.selected=o,d(i,function(l,u){var p=this.getSelectedMapKey(l);o.hasOwnProperty(p)||(o[p]=!0)},this),a.selectedMode==="single"){var s=!1;d(i,function(l,u){var p=this.getSelectedMapKey(l);o[p]&&(s?o[p]=!1:s=!0)},this)}},r.prototype.getItemSymbol=function(){return this.get("itemSymbol")},r.prototype.getSelectedMapKey=function(e){return this._mode==="categories"?e.value+"":e.index+""},r.prototype.getPieceList=function(){return this._pieceList},r.prototype._determineMode=function(){var e=this.option;return e.pieces&&e.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},r.prototype.setSelected=function(e){this.option.selected=A(e)},r.prototype.getValueState=function(e){var t=w.findPieceIndex(e,this._pieceList);return t!=null&&this.option.selected[this.getSelectedMapKey(this._pieceList[t])]?"inRange":"outOfRange"},r.prototype.findTargetDataIndices=function(e){var t=[],a=this._pieceList;return this.eachTargetSeries(function(i){var o=[],s=i.getData();s.each(this.getDataDimensionIndex(s),function(l,u){var p=w.findPieceIndex(l,a);p===e&&o.push(u)},this),t.push({seriesId:i.id,dataIndex:o})},this),t},r.prototype.getRepresentValue=function(e){var t;if(this.isCategory())t=e.value;else if(e.value!=null)t=e.value;else{var a=e.interval||[];t=a[0]===-1/0&&a[1]===1/0?0:(a[0]+a[1])/2}return t},r.prototype.getVisualMeta=function(e){if(this.isCategory())return;var t=[],a=["",""],i=this;function o(p,c){var h=i.getRepresentValue({interval:p});c||(c=i.getValueState(h));var f=e(h,c);p[0]===-1/0?a[0]=f:p[1]===1/0?a[1]=f:t.push({value:p[0],color:f},{value:p[1],color:f})}var s=this._pieceList.slice();if(!s.length)s.push({interval:[-1/0,1/0]});else{var l=s[0].interval[0];l!==-1/0&&s.unshift({interval:[-1/0,l]}),l=s[s.length-1].interval[1],l!==1/0&&s.push({interval:[l,1/0]})}var u=-1/0;return d(s,function(p){var c=p.interval;c&&(c[0]>u&&o([u,c[0]],"outOfRange"),o(c.slice()),u=c[1])},this),{stops:t,outerColors:a}},r.type="visualMap.piecewise",r.defaultOption=cr(_e.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),r}(_e),ki={splitNumber:function(n){var r=this.option,e=Math.min(r.precision,20),t=this.getExtent(),a=r.splitNumber;a=Math.max(parseInt(a,10),1),r.splitNumber=a;for(var i=(t[1]-t[0])/a;+i.toFixed(e)!==i&&e<5;)e++;r.precision=e,i=+i.toFixed(e),r.minOpen&&n.push({interval:[-1/0,t[0]],close:[0,0]});for(var o=0,s=t[0];o<a;s+=i,o++){var l=o===a-1?t[1]:s+i;n.push({interval:[s,l],close:[1,1]})}r.maxOpen&&n.push({interval:[t[1],1/0],close:[0,0]}),qe(n),d(n,function(u,p){u.index=p,u.text=this.formatValueText(u.interval)},this)},categories:function(n){var r=this.option;d(r.categories,function(e){n.push({text:this.formatValueText(e,!0),value:e})},this),Nt(r,n)},pieces:function(n){var r=this.option;d(r.pieces,function(e,t){X(e)||(e={value:e});var a={text:"",index:t};if(e.label!=null&&(a.text=e.label),e.hasOwnProperty("value")){var i=a.value=e.value;a.interval=[i,i],a.close=[1,1]}else{for(var o=a.interval=[],s=a.close=[0,0],l=[1,0,1],u=[-1/0,1/0],p=[],c=0;c<2;c++){for(var h=[["gte","gt","min"],["lte","lt","max"]][c],f=0;f<3&&o[c]==null;f++)o[c]=e[h[f]],s[c]=l[f],p[c]=f===2;o[c]==null&&(o[c]=u[c])}p[0]&&o[1]===1/0&&(s[0]=0),p[1]&&o[0]===-1/0&&(s[1]=0),o[0]===o[1]&&s[0]&&s[1]&&(a.value=o[0])}a.visual=w.retrieveVisuals(e),n.push(a)},this),Nt(r,n),qe(n),d(n,function(e){var t=e.close,a=[["<","≤"][t[1]],[">","≥"][t[0]]];e.text=e.text||this.formatValueText(e.value!=null?e.value:e.interval,!1,a)},this)}};function Nt(n,r){var e=n.inverse;(n.orient==="vertical"?!e:e)&&r.reverse()}var Ni=function(n){V(r,n);function r(){var e=n!==null&&n.apply(this,arguments)||this;return e.type=r.type,e}return r.prototype.doRender=function(){var e=this.group;e.removeAll();var t=this.visualMapModel,a=t.get("textGap"),i=t.textStyleModel,o=i.getFont(),s=i.getTextColor(),l=this._getItemAlign(),u=t.itemSize,p=this._getViewData(),c=p.endsText,h=tr(t.get("showLabel",!0),!c);c&&this._renderEndsText(e,c[0],u,h,l),d(p.viewPieceList,function(f){var v=f.piece,g=new D;g.onclick=T(this._onItemClick,this,v),this._enableHoverLink(g,f.indexInModelPieceList);var y=t.getRepresentValue(v);if(this._createItemSymbol(g,y,[0,0,u[0],u[1]]),h){var m=this.visualMapModel.getValueState(y);g.add(new ee({style:{x:l==="right"?-a:u[0]+a,y:u[1]/2,text:v.text,verticalAlign:"middle",align:l,font:o,fill:s,opacity:m==="outOfRange"?.5:1}}))}e.add(g)},this),c&&this._renderEndsText(e,c[1],u,h,l),_a(t.get("orient"),e,t.get("itemGap")),this.renderBackground(e),this.positionGroup(e)},r.prototype._enableHoverLink=function(e,t){var a=this;e.on("mouseover",function(){return i("highlight")}).on("mouseout",function(){return i("downplay")});var i=function(o){var s=a.visualMapModel;s.option.hoverLink&&a.api.dispatchAction({type:o,batch:he(s.findTargetDataIndices(t),s)})}},r.prototype._getItemAlign=function(){var e=this.visualMapModel,t=e.option;if(t.orient==="vertical")return Vr(e,this.api,e.itemSize);var a=t.align;return(!a||a==="auto")&&(a="left"),a},r.prototype._renderEndsText=function(e,t,a,i,o){if(t){var s=new D,l=this.visualMapModel.textStyleModel;s.add(new ee({style:pe(l,{x:i?o==="right"?a[0]:0:a[0]/2,y:a[1]/2,verticalAlign:"middle",align:i?o:"center",text:t})})),e.add(s)}},r.prototype._getViewData=function(){var e=this.visualMapModel,t=E(e.getPieceList(),function(s,l){return{piece:s,indexInModelPieceList:l}}),a=e.get("text"),i=e.get("orient"),o=e.get("inverse");return(i==="horizontal"?o:!o)?t.reverse():a&&(a=a.slice().reverse()),{viewPieceList:t,endsText:a}},r.prototype._createItemSymbol=function(e,t,a){e.add(ge(this.getControllerVisual(t,"symbol"),a[0],a[1],a[2],a[3],this.getControllerVisual(t,"color")))},r.prototype._onItemClick=function(e){var t=this.visualMapModel,a=t.option,i=a.selectedMode;if(i){var o=A(a.selected),s=t.getSelectedMapKey(e);i==="single"||i===!0?(o[s]=!0,d(o,function(l,u){o[u]=u===s})):o[s]=!o[s],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:o})}},r.type="visualMap.piecewise",r}(xr);function Yi(n){n.registerComponentModel(Hi),n.registerComponentView(Ni),Ir(n)}function Wi(n){Fe(Ei),Fe(Yi)}export{wa as R,Sr as V,gi as a,Zi as b,xa as c,fi as d,w as e,ut as f,Dt as g,Ji as h,Wi as i,Ei as j,Yi as k,Si as r,Ta as u};
